const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SelfSnappingEngine-CMrE27N9.js","./index-Cf67L9ml.js","./index-C9zlu8m2.css","./quantityUtils-BqZKwIL9.js","./elevationInfoUtils-oDUK5Esi.js","./hitTestSelectUtils-CaIdoykw.js","./projectVectorToVector-CBL9pf0P.js","./projectPointToVector-BSS7uX7z.js","./geodesicUtils-D1DPj1dv.js","./plane-DIsjDFau.js","./mat3f64-q3fE-ZOt.js","./mat4f64-Dk4dwAN8.js","./quatf64-aQ5IuZRd.js","./sphere-DX54r7eT.js","./geodesicLengthMeasurementUtils-kJk85tIo.js","./geometryEngine-D2SVCczb.js","./geometryEngineBase-yFIvKOkM.js","./_commonjsHelpers-DCkdB7M8.js","./hydrated-BGSOguYR.js","./GraphicsLayer-CnEiQaV5.js","./Stop-9IKBjUm4.js","./networkEnums-DGVjDPmw.js","./GridSnappingEngine-C6yQNi0Y.js","./gridUtils-Ao5gpTdI.js","./FeatureSnappingEngine-KU8ClFtE.js","./floorFilterUtils-DZ5C6FQv.js","./layerViewUtils-BErokGJI.js","./editingTools-DJ6HBL5e.js","./SnappingVisualizer2D-gjLW-4Ds.js","./SnappingContext-BZxL1Wcw.js","./PointSnappingHint-DZW3jzPZ.js","./automaticLengthMeasurementUtils-FJRDEbUh.js","./MeshTransform-Cau_U18k.js","./quat-xUBAXqLq.js","./axisAngleDegrees-xNP9Ar1W.js","./meshVertexSpaceUtils-yusu8Jvp.js","./MeshLocalVertexSpace-1m3iQoyf.js","./memoize-DsJmrG76.js","./unitFormatUtils-lUzqPUVT.js","./ByteSizeUnit-BsxeN7wM.js","./spatialReferenceEllipsoidUtils-CVi6cHf_.js","./earcut-Lltz9D9k.js","./triangle-DnjJVllB.js","./lineSegment-BFb_0lpP.js","./editPlaneUtils-DKfzI6BB.js","./ReactiveSet-CabQQ-hx.js","./hydratedFeatures-D35lfFQh.js","./boundedPlane-DDgJuCNE.js","./cimSymbolUtils-TzjN9ZKv.js","./GraphicManipulator-YJ9YVt3w.js","./drapedUtils-Y3X1UEQX.js","./colorUtils-BvMoCY37.js","./drawUtils-CMKVXbvx.js","./ImageMaterial.glsl-Bw-3Bfrt.js","./Octree-DQWL6E3H.js","./InterleavedLayout-DrwjvGL8.js","./BufferView-Cu1yI3AK.js","./types-D0PSWh4d.js","./RibbonLine.glsl-DYdpK_yZ.js","./orientedBoundingBox-Dek8Im5U.js","./computeTranslationToOriginAndRotation-B3nIFk4k.js","./Geometry-CVuBYBHt.js","./renderState-8dGEQHZv.js","./basicInterfaces-CZwQPxTp.js","./ShaderOutput-DnYY5J1_.js","./BindType-BBwFZqyN.js","./glsl-BH37Aalp.js","./VertexAttribute-Cq4MnHjR.js","./requestImageUtils-CJ-NnBwR.js","./TextureFormat-1mYWTFa-.js","./Indices-DSc_a5T3.js","./dehydratedFeatureUtils-C9cdqe3h.js","./doublePrecisionUtils-B0owpBza.js","./vec3f32-nZdmKIgz.js","./floatRGBA-18oZY0RD.js","./ShaderBuilder-j36oj-lW.js","./DefaultLayouts-CoGf_Ndr.js","./triangulationUtils-DyPwrXrc.js","./deduplicate-YYVoNtIY.js","./HUDMaterial-cT_5YJDU.js","./VertexArrayObject-s3q2lkkQ.js","./VertexElementDescriptor-BOD-G50G.js","./BufferObject-ea8Voym7.js","./NestedMap-GuqgquCN.js","./glUtil-CtdP1KOQ.js","./IntersectorInterfaces-BgX4KEwK.js","./SelectedVertexTooltipInfo-DHG33D6L.js","./TranslateTooltipInfo-BTa_f3QP.js","./utils-CL36WIO8.js","./persistable-CFxB4l0Z.js","./multiOriginJSONSupportUtils-C0wm8_Yw.js","./resourceExtension-COZ86vUH.js","./ExtentScaleTooltipInfo-8IWnHtpn.js","./LineCallout.glsl-CUlP0aeG.js","./dehydratedFeatures-CnW_BW0R.js","./rendererConversion-CTLDxIh_.js","./LodResources-BaiNAkiR.js","./edgeUtils-CvzX-EyF.js","./NormalAttribute.glsl-6jnyC1rq.js","./DefaultMaterial-MjmDdBi_.js","./optimizedFeatureQueryEngineAdapter-D6HydSKn.js","./webStyleAcceptedFormats-CG7ZQ6BV.js","./PooledRBush-CHYIYmNu.js","./popupUtils-BAVTkRsj.js","./geometryServiceUtils-BJWJXUA3.js","./project-IeldZ0YS.js","./LayerView-zDsSwpRo.js","./Container-BEHKQm5A.js","./EffectView-CkK6NJdN.js","./GraphicMover-CwCSePV7.js","./featureUtils-yZzjat6j.js","./utils-C6HuIF-b.js","./Box-CJvycJtF.js","./settings-Ie_2kY2I.js","./Reshape-Cf6ieFRv.js"])))=>i.map(i=>d[i]);
import{W as h,Z as u,ap as V,bV as se,aV as $,ak as Ue,a as We,aJ as ze,fJ as Xe,fL as Je,ar as B,kZ as Qe,aG as re,nj as et,bg as tt,j5 as it,k4 as at,f1 as ve,a1 as U,eE as Q,fr as ot,gO as st,_ as G,as as ne,ed as ye,fh as rt,kF as nt,js as pt,hE as Ve,gt as Ee,gu as lt,gr as ht,qp as ct,qq as dt,dy as we,ea as F,e9 as ut,kp as pe,c7 as Se,av as yt,ax as gt,eb as vt,ec as mt,qr as _t,kT as ft,hG as w,ln as Te,qs as R,h_ as Oe,b as bt,jS as Ge,h9 as Et,oE as q,j1 as Me,e6 as wt,hF as St}from"./index-Cf67L9ml.js";import{h as $e}from"./GraphicsLayer-CnEiQaV5.js";import{a as Tt,j as Ot,T as Gt,w as Mt}from"./Stop-9IKBjUm4.js";import{v as Fe,l as Pt,f as Rt,x as Ct,j as ge}from"./elevationInfoUtils-oDUK5Esi.js";import{p as ie,i as C,z as kt,A as k,B as A,L as At,g as Dt,C as It,R as Ne,n as je,D as Ht,F as qe,G as Lt,s as Pe,H as Z,b as le,K as Re,E as xt,u as Ut,l as Ye,O as Vt,v as $t,m as b,P as Ft,Q as Nt,S as jt}from"./hitTestSelectUtils-CaIdoykw.js";import{e as qt}from"./projectVectorToVector-CBL9pf0P.js";function Ce(e){switch(e){case _.SUPPORTED:break;case _.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case _.GEOMETRY_MISSING:return"no geometry";case _.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case _.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case _.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var _;(function(e){e[e.SUPPORTED=0]="SUPPORTED",e[e.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",e[e.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",e[e.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",e[e.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",e[e.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(_||(_={}));function Yt(e){var a,o;if(e.graphic&&((a=e.graphic.layer)==null?void 0:a.type)!=="graphics")return _.GRAPHICS_LAYER_MISSING;const t=(o=e.operations)==null?void 0:o.data.type;if(!t)return _.GEOMETRY_TYPE_UNSUPPORTED;switch(t){case"polygon":case"point":case"polyline":case"mesh":break;default:return _.GEOMETRY_TYPE_UNSUPPORTED}const i=e.elevationInfo;return Fe(i)?_.ELEVATION_MODE_UNSUPPORTED:_.SUPPORTED}function Bt(e){return Zt(e).result}function Zt(e){var a;if(e.graphic&&((a=e.graphic.layer)==null?void 0:a.type)!=="graphics")return{result:_.GRAPHICS_LAYER_MISSING};if(!e.operations)return{result:_.GEOMETRY_MISSING};if(Fe(e.elevationInfo))return{result:_.ELEVATION_MODE_UNSUPPORTED};const t=e.operations.data.type,i=e.operations.data.geometry;return t==="point"||t==="mesh"||t==="polyline"||t==="polygon"?{result:_.SUPPORTED,geometry:i}:{result:_.GEOMETRY_TYPE_UNSUPPORTED}}function Kt(e){var i;if(((i=e.layer)==null?void 0:i.type)!=="graphics")return _.GRAPHICS_LAYER_MISSING;if(e.geometry==null)return _.GEOMETRY_MISSING;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return _.SUPPORTED;default:return _.GEOMETRY_TYPE_UNSUPPORTED}const t=e.symbol!=null&&e.symbol.type==="point-3d"&&e.symbol.symbolLayers;return!t||!t.some(a=>a.type==="object")?_.SYMBOL_TYPE_UNSUPPORTED:Pt(e)!=="on-the-ground"&&Rt(e)?_.ELEVATION_MODE_UNSUPPORTED:_.SUPPORTED}function ke(e,t,i){if(!t||!(e!=null&&e.map))return;const{map:a}=e,o=a.layers.find(s=>s===t);o||a.add(t,i),o&&i!=null&&a.layers.reorder(o,i)}function Ti(e,t){const i=(t==null?void 0:t.type)==="subtype-sublayer"?t.parent:t;return e.allLayerViews.find(a=>{const o=a.layer;return o===i||"sublayers"in o&&o.sublayers!=null&&o.sublayers.includes(i)})}let L=class extends se{constructor(t){super(t),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new $}};h([u({constructOnly:!0})],L.prototype,"layer",void 0),h([u()],L.prototype,"enabled",void 0),h([u()],L.prototype,"updating",void 0),h([u()],L.prototype,"availability",void 0),h([u()],L.prototype,"sublayerSources",void 0),L=h([V("esri.views.interactive.snapping.FeatureSnappingLayerSource")],L);const Be=L;let T=class extends se{constructor(t){super(t),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new $,this.distance=ie.distance,this.touchSensitivityMultiplier=ie.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){var c;const t=this.featureSources;t.some(Ae)&&Ue.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const i=t.filter(zt),a=((c=this._get("_effectiveFeatureSources"))==null?void 0:c.filter(Ae))??new $;for(const p of i){const d=a.find(l=>l.layer===p.layer.parent);if(d)d.sublayerSources.includes(p)||d.sublayerSources.add(p);else if(p.layer.parent){const l=new Be({layer:p.layer.parent});l.sublayerSources.add(p),a.add(l)}}for(const p of a){const d=p.sublayerSources.filter(l=>!i.includes(l));p.sublayerSources.removeMany(d)}a.removeMany(a.filter(p=>p.sublayerSources.length===0));const o=t.filter(Wt),s=this._get("_effectiveFeatureSources")??new $,{added:n,removed:r}=We(s.toArray(),[...o,...a]);return s.removeMany(r),s.addMany(n),s}};h([u()],T.prototype,"enabled",void 0),h([u()],T.prototype,"enabledToggled",void 0),h([u()],T.prototype,"forceDisabled",void 0),h([u()],T.prototype,"selfEnabled",void 0),h([u()],T.prototype,"featureEnabled",void 0),h([u()],T.prototype,"gridEnabled",void 0),h([u()],T.prototype,"attributeRulesEnabled",void 0),h([u({type:$.ofType(Be)})],T.prototype,"featureSources",void 0),h([u()],T.prototype,"distance",void 0),h([u()],T.prototype,"touchSensitivityMultiplier",void 0),h([u({readOnly:!0})],T.prototype,"effectiveEnabled",null),h([u({readOnly:!0})],T.prototype,"effectiveGridEnabled",null),h([u({readOnly:!0})],T.prototype,"effectiveSelfEnabled",null),h([u({readOnly:!0})],T.prototype,"effectiveFeatureEnabled",null),h([u({readOnly:!0})],T.prototype,"_effectiveFeatureSources",null),T=h([V("esri.views.interactive.snapping.SnappingOptions")],T);const me=T;function Ae(e){return e.layer.type==="subtype-group"}function Wt(e){return e.layer.type!=="subtype-group"}function zt(e){return e.layer.type==="subtype-sublayer"}class j{constructor(t,i,a,o){this.targetPoint=t,this.constraint=i,this.isDraped=a,this.domain=o}}let Ze=class extends j{constructor({targetPoint:t,objectId:i,constraint:a,isDraped:o}){super(t,a,o,C.FEATURE),this.objectId=i}},Xt=class extends Ze{constructor(t){super({...t,isDraped:!0,constraint:new kt(t.edgeStart,t.edgeEnd,t.getGroundElevation)})}get hints(){return[new k(A.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},Jt=class extends Ze{constructor(t){super({...t,constraint:new At(t.edgeStart,t.edgeEnd)})}get hints(){return[new k(A.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},ee=class extends j{constructor(t,i,a,o){super(t,new Dt(t),o,C.ALL),this.first=i,this.second=a}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new It(this.targetPoint,this.isDraped,this.domain)]}};class Qt extends j{constructor({lineStart:t,lineEnd:i,targetPoint:a,isDraped:o}){super(a,new Ne(t,i),o,C.SELF),this._referenceLineHint=new k(A.REFERENCE_EXTENSION,t,i,o,this.domain)}get hints(){return[this._referenceLineHint,new k(A.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}let ei=class extends j{constructor({referenceLine:t,lineStart:i,targetPoint:a,isDraped:o}){const s=ze(i),{left:n,right:r}=t;Xe(s,Je(s,s,r),n),super(a,new Ne(i,je(s)),o,C.SELF),this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new k(A.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new Ht(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(t=>new k(A.REFERENCE,t.edge.left,t.edge.right,this.isDraped,this.domain,t.fadeLeft,t.fadeRight))]}addReferenceLine(t){const i={edge:t,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(a=>{B(t.right,a.edge.left)&&(a.fadeLeft=!1,i.fadeRight=!1),B(t.right,a.edge.right)&&(a.fadeRight=!1,i.fadeRight=!1),B(t.left,a.edge.right)&&(a.fadeRight=!1,i.fadeLeft=!1),B(t.left,a.edge.left)&&(a.fadeLeft=!1,i.fadeLeft=!1)}),this._referenceLines.push(i)}},ti=class extends j{constructor({targetPoint:t,constraint:i,previousVertex:a,otherVertex:o,otherVertexType:s,isDraped:n,selfSnappingType:r,objectId:c,domain:p}){super(t,i,n,p??C.SELF),this.previousVertex=a,this.otherVertex=o,this.otherVertexType=s,this.selfSnappingType=r??oe.None,this.objectId=c??null}get hints(){const t=this.previousVertex,i=this.otherVertexType===ae.CENTER?this.otherVertex:this.targetPoint,a=this.otherVertexType===ae.CENTER?this.targetPoint:this.otherVertex;return[new k(A.TARGET,i,a,this.isDraped,this.domain),new k(A.REFERENCE,t,i,this.isDraped,this.domain),new qe(this.previousVertex,i,a,this.isDraped,this.domain)]}};var ae,oe;(function(e){e[e.NEXT=0]="NEXT",e[e.CENTER=1]="CENTER"})(ae||(ae={})),function(e){e[e.None=0]="None",e[e.LastVertex=1]="LastVertex",e[e.FirstVertex=2]="FirstVertex",e[e.ExistingEdge=3]="ExistingEdge"}(oe||(oe={}));let ii=class extends j{constructor({targetPoint:t,point1:i,point2:a,isDraped:o}){super(t,new Lt(je(Qe(re(),i,a,.5)),.5*et(Pe(i),Pe(a))),o,C.SELF),this._p1=i,this._p2=a}get hints(){return[new k(A.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new k(A.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new qe(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}};function ai(e,t,i,a,o=re()){const s=tt(oi,e);return s[2]=Ct(a,s,t,i)||0,a.renderCoordsHelper.toRenderCoords(s,t,o),o}const oi=re();function si(e,t,i,a){return a.type==="2d"?(K.x=e[0],K.y=e[1],K.spatialReference=t,a.toScreen(K)):(ai(e,t,i,a,De),a.state.camera.projectToScreen(De,he),it(he[0],he[1]))}const K=qt(0,0,0,null),De=re(),he=at();let P=class extends ve.EventedMixin(se){constructor(e){super(e),this.options=new me,this._engineCache=new Map,this._loadTask=null,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=D.MAIN}initialize(){this.addHandles([U(()=>{const{distance:e,touchSensitivityMultiplier:t,effectiveSelfEnabled:i,effectiveFeatureEnabled:a,effectiveGridEnabled:o}=this.options;return{selfEnabled:i,featureEnabled:a,gridEnabled:this.view.type==="2d"&&o,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:e,touchSensitivityMultiplier:t}},(e,t)=>{var i;t&&(this.doneSnapping(),this.emit("changed")),(i=this._loadTask)==null||i.abort(),this._loadTask=ot(a=>this._updateEngines(e,t,a))},Q),U(()=>this.options,e=>{for(const t of this._engines)t.options=e},st)])}destroy(){var e;(e=this._loadTask)==null||e.abort(),this._destroyEngines()}get updating(){var e;return this._engines.some(t=>t.updating)||!((e=this._loadTask)!=null&&e.finished)}_destroyEngines(){this._engineCache.forEach(e=>e.destroy()),this._engineCache.clear(),this._engines=[]}async _updateEngines(e,t,i){var s;if(!e.viewReady)return void this._destroyEngines();(t==null?void 0:t.viewSpatialReference)!==e.viewSpatialReference&&this._destroyEngines();const a=this._engineCache,o=await Promise.allSettled([e.featureEnabled&&!a.has("feature")?this._createFeatureSnappingEngine(i):void 0,e.selfEnabled&&!a.has("self")?this._createSelfSnappingEngine(i):void 0,e.gridEnabled&&!a.has("grid")?this._createGridSnappingEngine(i):void 0]);if(i.aborted)for(const n of o)n.status==="fulfilled"&&((s=n.value)==null||s.engine.destroy());else{for(const n of o)n.status==="fulfilled"&&n.value&&a.set(n.value.type,n.value.engine);this._engines=Array.from(a.values())}}async _createSelfSnappingEngine(e){const{SelfSnappingEngine:t}=await G(()=>import("./SelfSnappingEngine-CMrE27N9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]),import.meta.url);return ne(e),{type:"self",engine:new t({view:this.view,options:this.options})}}async _createGridSnappingEngine(e){const{view:t}=this;if(t.type!=="2d")return;const{GridSnappingEngine:i}=await G(()=>import("./GridSnappingEngine-C6yQNi0Y.js"),__vite__mapDeps([22,1,2,23,8,5,3,6,7,9,10,11,12,13,4,19,20,21]),import.meta.url);return ne(e),{type:"grid",engine:new i({view:t,options:this.options})}}async _createFeatureSnappingEngine(e){const{FeatureSnappingEngine:t}=await G(()=>import("./FeatureSnappingEngine-KU8ClFtE.js"),__vite__mapDeps([24,1,2,4,5,3,6,7,8,9,10,11,12,13,25,26,19,20,21]),import.meta.url);ne(e);const{view:i,options:a}=this,{spatialReference:o}=i;return{type:"feature",engine:new t({view:i,options:a,spatialReference:o})}}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,i=e*t;return i*i}snap(e){return pi(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:i}=e;this._removeVisualization();const a=this._currentMainCandidate;if(a==null)return t;const o=this._selectUpdateInput(e);if(o==null)return t;const{spatialReference:s}=i,n=ye(o,s);if(n==null)return t;const{view:r}=this,{elevationInfo:c,visualizer:p}=i,d=[],l=Z(n,r,c),v=a.constraint.closestTo(l);if(!this._arePointsWithinScreenThreshold(l,v,i)||!de(a,i.drawConstraints))return this._resetSnappingState(),t;a.targetPoint=le(v),d.push(...a.hints);for(const y of this._currentOtherActiveCandidates)de(y,i.drawConstraints)&&(y.targetPoint=le(v),d.push(...y.hints));return p!=null&&this.addHandles(p.draw(d,{spatialReference:s,elevationInfo:li(i),view:r,selfSnappingZ:i.selfSnappingZ}),ce),Re(v,r,t,i)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:t}){switch(this._currentSnappedType){case D.MAIN:return e;case D.SCENE:return t}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=D.MAIN}_removeVisualization(){this.removeHandles(ce)}async _snapSinglePoint({point:e,context:t,signal:i}){const{view:a}=this,{elevationInfo:o}=t,s=Z(e,a,o),n=await this._fetchCandidates(s,C.ALL,t,i);return this._createSnapResult(s,D.MAIN,n,a,e,t,i)}async _snapMultiPoint({point:e,scenePoint:t,context:i,signal:a}){const{view:o}=this,{coordinateHelper:s,elevationInfo:n,spatialReference:r}=i;await rt(t.spatialReference,r);const c=ye(t,r),p=Z(c,o,n),d=await this._fetchCandidates(p,C.FEATURE,i,a);if(d.length>0){const y=await this._fetchCandidates(p,C.SELF,i,a);return this._createSnapResult(p,D.SCENE,[...d,...y],o,c,i,a)}const l=Z(e,o,n),v=await this._fetchCandidates(l,C.SELF,i,a);return this._createSnapResult(l,D.MAIN,v,o,{z:s.hasZ()&&e.hasZ?e.z??0:void 0,m:s.hasM()&&e.hasM?e.m??0:void 0},i,a)}async _fetchCandidates(e,t,i,a){return(await Promise.all(this._engines.map(o=>o.fetchCandidates(e,t,i,a)))).flat()}_createSnapResult(e,t,i,a,o,s,n){return{get valid(){return!nt(n)},apply:()=>{const{spatialReference:r}=s,{snappedPoint:c,hints:p}=this._processCandidates(e,t,i,s);return this._removeVisualization(),s.visualizer!=null&&this.addHandles(s.visualizer.draw(p,{spatialReference:r,elevationInfo:ge,view:a,selfSnappingZ:s.selfSnappingZ}),ce),Re(c,a,o,s)}}}_processCandidates(e,t,i,a){if(i.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),xt(e,i);const o=this._currentMainCandidate;if(o!=null){const s=ni(o,i);if(s>=0){if(!(i[s]instanceof ee))return this._intersectWithOtherCandidates(s,i,e,t,a);if(this._arePointsWithinScreenThreshold(e,o.targetPoint,a))return this._updateSnappingCandidate(o,t,i,a)}}return this._intersectWithOtherCandidates(0,i,e,t,a)}_intersectWithOtherCandidates(e,t,i,a,o){const{coordinateHelper:s}=o,n=t[e],r=[];for(let c=0;c<t.length;++c){if(c===e)continue;const p=t[c],d=n.constraint.intersect(p.constraint);if(d)for(const l of d.closestPoints(n.targetPoint))r.push([new ee(le(l),n,p,p.isDraped),this._squaredScreenDistance(i,l,s)])}return r.length>0&&(r.sort((c,p)=>c[1]-p[1]),r[0][1]<this._squaredPointProximityThreshold(o.pointer))?this._updateSnappingCandidate(r[0][0],a,t,o):de(n,o.drawConstraints)?this._updateSnappingCandidate(n,a,t,o):{snappedPoint:i,hints:[]}}_updateSnappingCandidate(e,t,i,a){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const o=this._currentMainCandidate.targetPoint,s=[];s.push(...e.hints);for(const n of i){if(e instanceof ee){if(n.constraint.equals(e.first.constraint)||n.constraint.equals(e.second.constraint))continue}else if(n.constraint.equals(e.constraint))continue;const r=n.constraint.closestTo(o);this._squaredScreenDistance(r,o,a.coordinateHelper)<ri()&&(n.targetPoint=o,this._currentOtherActiveCandidates.push(n),s.push(...n.hints))}return{snappedPoint:o,hints:s}}_squaredPointProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(e,t,i){return this._squaredScreenDistance(e,t,i.coordinateHelper)<this._squaredPointProximityThreshold(i.pointer)}_squaredScreenDistance(e,t,i){return Ut(this._toScreen(e,i),this._toScreen(t,i))}_toScreen(e,t){return si(e,t.spatialReference,ge,this.view)}get test(){}};var D;h([u({constructOnly:!0})],P.prototype,"view",void 0),h([u()],P.prototype,"options",void 0),h([u({readOnly:!0})],P.prototype,"updating",null),h([u()],P.prototype,"_loadTask",void 0),h([u()],P.prototype,"_engines",void 0),h([u()],P.prototype,"_squaredMouseProximityThreshold",null),h([u()],P.prototype,"_squaredTouchProximityThreshold",null),P=h([V("esri.views.interactive.snapping.SnappingManager")],P),function(e){e[e.MAIN=0]="MAIN",e[e.SCENE=1]="SCENE"}(D||(D={}));const ce="visualization-handle";function ri(){return ie.satisfiesConstraintScreenThreshold*ie.satisfiesConstraintScreenThreshold}function de(e,t){return!t||t.direction==null&&t.distance==null||!(e instanceof Xt||e instanceof Jt||e instanceof Qt||e instanceof ei||e instanceof ii)&&(!(e instanceof ti)||t.direction==null&&e.selfSnappingType===oe.LastVertex)}function ni(e,t){return e instanceof ee?ue(t,e.first)>=0&&ue(t,e.second)>=0?0:-1:ue(t,e)}function ue(e,t){let i=-1;for(let a=0;a<e.length;++a)if(t.constraint.equals(e[a].constraint)){i=a;break}return i}function pi(e){return e.scenePoint!=null}function li({coordinateHelper:e,elevationInfo:t}){return e.hasZ()?ge:t}let O=class extends ve.EventedAccessor{constructor(t){super(t),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:pt(this.activeComponent)}return null}addToHistory(t){this.history.redo=[],this.history.undo.push(t)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var t;(t=this.activeComponent)==null||t.reset()}refreshComponent(){const t=this.activeComponent;t&&(t.type!=="box"&&t.type!=="reshape"&&t.type!=="graphic-mover"||t.refresh())}set undo(t){this._set("undo",()=>{this.canUndo()&&t()})}set redo(t){this._set("redo",()=>{this.canRedo()&&t()})}};h([u()],O.prototype,"activeComponent",void 0),h([u()],O.prototype,"cancelled",void 0),h([u()],O.prototype,"history",void 0),h([u()],O.prototype,"tool",null),h([u()],O.prototype,"type",void 0),h([u()],O.prototype,"canUndo",null),h([u()],O.prototype,"canRedo",null),h([u()],O.prototype,"onEnd",void 0),h([u()],O.prototype,"undo",null),h([u()],O.prototype,"redo",null),h([u()],O.prototype,"toggleTool",void 0),h([u()],O.prototype,"addToSelection",void 0),h([u()],O.prototype,"removeFromSelection",void 0),O=h([V("esri.widgets.Sketch.support.OperationHandle")],O);let te=class extends O{};h([u()],te.prototype,"activeComponent",void 0),te=h([V("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],te);let I=class extends O{};h([u()],I.prototype,"activeComponent",void 0),I=h([V("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],I);function hi(e,t){return t==="freehandPolygon"||t==="freehandPolyline"?"freehand":e??(t==="rectangle"||t==="circle"?"hybrid":"click")}function ci(e){switch(e){case"freehandPolygon":return"polygon";case"freehandPolyline":return"polyline";default:return e}}var Ie;(function(e){e[e.ForceCollapse=-1]="ForceCollapse",e[e.Low=0]="Low",e[e.Medium=10]="Medium",e[e.High=100]="High",e[e.Max=1e3]="Max"})(Ie||(Ie={}));const He={defaultZ:0},Y={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let m=class extends ve.EventedAccessor{constructor(e){var t;super(e),this._defaultSnappingManager=null,this._updatingHandles=new Ve,this._internalGraphicsLayer=new $e({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new Ee({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new lt({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new ht({color:[130,130,130,1],width:2}),this.meshSymbol=new ct({symbolLayers:new $([new dt])}),this.updateGraphics=new $,this.updateOnGraphicClick=!0,this.creationMode="single",this.vertexSymbol=new Ee({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new Ye,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._sketchContinuationFlag=!1,this._originalPopupEnabled=null,this.defaultCreateOptions=He,this.defaultUpdateOptions=Y,this.snappingOptions=((t=e==null?void 0:e.snappingManager)==null?void 0:t.options)??(e==null?void 0:e.snappingOptions)??new me}initialize(){this.addHandles([we(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.layers},"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),we(()=>{var e;return(e=this.layer)==null?void 0:e.graphics},"change",e=>{if(this._operationHandle!=null)for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())}),U(()=>{var e;return((e=this.layer)==null?void 0:e.elevationInfo)??null},e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},Q),U(()=>this.view,e=>{this._defaultSnappingManager=F(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new P({view:e,options:this.snappingOptions})),e.type==="2d"?G(()=>import("./editingTools-DJ6HBL5e.js"),__vite__mapDeps([27,1,2,28,5,3,6,7,8,9,10,11,12,13,4,29,30,31,32,33,34,35,36,37,38,39,40,14,15,16,17,18,41,42,43,44,19,45,46,47,48,49,50,51,52]),import.meta.url):e.type==="3d"&&(G(()=>import("./ImageMaterial.glsl-Bw-3Bfrt.js").then(t=>t.e),__vite__mapDeps([53,1,2,51,4,31,3,32,11,33,10,12,34,35,36,5,6,7,8,9,13,37,38,39,40,14,15,16,17,18,54,55,56,57,43,58,59,60,61,62,63,64,65,66,67,47,68,69,70,42,71,72,46,73,74,75,76,77,41,78,79,80,81,82,83,84,29,30,44,19,45,85,86,87,88,48,89,90,91,92,49,50]),import.meta.url),G(()=>import("./LineCallout.glsl-CUlP0aeG.js").then(t=>t.G),__vite__mapDeps([93,1,2,7,6,4,58,59,10,11,33,12,40,60,9,61,62,63,64,65,66,67,47,13,43,68,69,55,56,57,70,42,71,72,35,36,46,73,54,74,75,94,95,96,85,97,98,99,100,101,102,103,26,104,105,106,107,108]),import.meta.url)))},Q),U(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,t)=>{e&&t&&!e.equals(t)&&this.cancel()})]),Vt(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=F(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this._updatingHandles.destroy(),this.emit("destroy")}get updating(){return this._updatingHandles.updating||this.snappingManager!=null&&this.snappingManager.updating}get activeTool(){var e;return((e=this._operationHandle)==null?void 0:e.tool)??null}get activeCreateToolDrawMode(){var e;return((e=this._operationHandle)==null?void 0:e.type)==="create"&&this._operationHandle.activeComponent&&"mode"in this._operationHandle.activeComponent?this._operationHandle.activeComponent.mode:null}get activeTooltip(){const{activeComponent:e,destroyed:t}=this,i=!t&&e&&"tooltip"in e?e.tooltip:null;return i!=null&&i.visible?i:null}get activeComponent(){var e;return((e=this._operationHandle)==null?void 0:e.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...He,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...Y,...e,reshapeOptions:{...Y.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...Y.highlightOptions,...e==null?void 0:e.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){var e;return((e=this.snappingManager)==null?void 0:e.options)??this._get("snappingOptions")}set snappingOptions(e){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=F(this._defaultSnappingManager)),this._override("snappingManager",e);else{const{view:t}=this;!this._defaultSnappingManager&&t&&(this._defaultSnappingManager=new P({options:this.snappingOptions,view:t})),this._clearOverride("snappingManager")}}get state(){var i;const e=!(!((i=this.view)!=null&&i.ready)||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:a,map:o}=t;a&&(t.cursor=null),o==null||o.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const i="view-ready";this.removeHandles(i),e&&this.addHandles(ut(()=>e.ready,a=>{this.removeHandles(this._viewHandlesKey),a&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)},Q),i),this._set("view",e)}cancel(){this._moduleLoaderAbortController=pe(this._moduleLoaderAbortController),this._viewReadyAbortController=pe(this._viewReadyAbortController),this._sketchContinuationFlag=!0,this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if(e==="active"&&t.length){const{activeTool:i,layer:a}=this,o=t.toArray();a.removeMany(o),this.cancel(),this._emitDeleteEvent({graphics:o,tool:i})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(t=>t.clone()).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,t){this.cancel(),await this._waitViewReady();const{view:i,layer:a}=this;if(!i||this.state==="disabled")throw a||this._logMissingLayer(),Se();if(i.activeTool!=null&&(i.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");ke(i,this._internalGraphicsLayer);const o=await this._updatingHandles.addPromise(this._setupCreateOperation(e,t));if(o==null||this.destroyed)return void i.map.remove(this._internalGraphicsLayer);const s=()=>{var n;if(o===this._operationHandle){const r=this.createGraphic,c=this._operationHandle.cancelled;if(this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(n=this.view)!=null&&n.map&&this.view.map.remove(this._internalGraphicsLayer),o.cancelled||r==null||a.add(r),this._sketchContinuationFlag=!1,this.emit("create",{graphic:r,state:c?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"}),c||this._sketchContinuationFlag)return;const{creationMode:p}=this;if(p==="continuous"){if(t!=null&&t.geometryToPlace)return;this._updatingHandles.addPromise(Me(this.create(e,t)))}else p==="update"&&r&&this._updatingHandles.addPromise(Me(this.update([r])))}};o.on("complete",s),this._operationHandle=o,i.ready&&i.focus()}async place(e,t){return this.create("mesh",{mode:"click",hasZ:e.hasZ,geometryToPlace:e,...t})}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:i,view:a,state:o}=this;if(!a||o==="disabled")throw i||this._logMissingLayer(),Se();a.activeTool!=null&&(a.activeTool=null);const s=Array.isArray(e)?e:[e];if(e==null||!(s!=null&&s.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(s.some(r=>r.layer!==i?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):r.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const n=await this._updatingHandles.addPromise(this._setupUpdateOperation(s,t));this.destroyed||n==null||E(n)||(ke(a,this._internalGraphicsLayer),this._setUpdateOperationHandle(n,t),this.emit("update",{graphics:s,state:"start",aborted:!1,tool:n.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const t=this.view;if(t){e=Array.isArray(e)?e:[e];for(const i of e)i.geometry==null||i.geometry.type==="mesh"||yt(i.geometry.spatialReference,t.spatialReference)||(gt(i.geometry.spatialReference,t.spatialReference)||vt()||await mt(),i.geometry=ye(i.geometry,t.spatialReference))}else this._logMissingView()}undo(){var e;this.canUndo()&&((e=this._operationHandle)==null||e.undo())}redo(){var e;this.canRedo()&&((e=this._operationHandle)==null||e.redo())}canUndo(){var e;return!!((e=this._operationHandle)!=null&&e.canUndo())}canRedo(){var e;return!!((e=this._operationHandle)!=null&&e.canRedo())}toggleUpdateTool(){var e;(e=this._operationHandle)==null||e.toggleTool()}async _getFirstHit(e){const t=this.view;if(!t)return this._logMissingView(),null;if(t.type==="2d"){const o=[];t.map.allLayers.forEach(n=>{n.type!=="vector-tile"&&n.type!=="imagery"||o.push(n)});const s=await t.hitTest(e,{exclude:o});return $t(s.results)}const i=[t.map.ground];t.map.allLayers.forEach(o=>{_t(o.type)&&i.push(o)});const a=await t.hitTest(e,{exclude:i});if(a.results.length>0){const o=a.results[0];if(o!=null&&o.type==="graphic"&&o.graphic&&(!a.ground.mapPoint||t.map.ground.opacity<1||a.ground.distance-(o.distance??0)>-Math.min(3*a.ground.distance,t.viewingMode==="global"?ft(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return o}return null}_generateViewHandles(e){return[e.on("immediate-click",async t=>{var a;const i=this.state==="active"&&((a=this._operationHandle)==null?void 0:a.type)==="create";this.state!=="disabled"&&!i&&this.updateOnGraphicClick&&await this._updatingHandles.addPromise(this._handleImmediateClick(t))},w.WIDGET)]}async _handleImmediateClick(e){var a;const t=await e.async(()=>this._getFirstHit(Te(e)));let i=null;if(t!=null){const o=t.graphic;this.updateGraphics.includes(o)||o.layer===this.layer?(e.stopPropagation(),i=o):((a=this.view)==null?void 0:a.type)!=="2d"||this._isComponentGraphic(o)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();i==null||this.updateGraphics.includes(i)||await this.update([i],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}})}async _setupCreateOperation(e,t){const i=this.view;if(!i)return this._logMissingView(),null;const a={hasZ:i.type==="3d",...this.defaultCreateOptions,...t},o=await this._setupDrawGraphicTool(e,i,a);return o==null?null:(i.tools.add(o),i.activeTool=o,this._setupCreateOperationHandle(o))}async _setupDrawGraphicTool(e,t,i){var S;if(e==="multipoint"&&t.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!t)return this._logMissingView(),null;const{cursor:a,defaultZ:o,hasZ:s,geometryToPlace:n,graphicProperties:r,mode:c,preserveAspectRatio:p}=i,d=hi(c,e),l=ci(e),v=(S=i==null?void 0:i.optionsPerTool)!=null&&S.has(e)?i.optionsPerTool.get(e):{},y=(v==null?void 0:v.preserveAspectRatio)??p??e!=="rectangle",g={centered:e!=="rectangle"&&!(e==="circle"&&!y),cursor:a,defaultZ:o,forceUniformSize:y,graphicProperties:{...r,attributes:{...r==null?void 0:r.attributes}},geometryToPlace:n,geometryType:l,mode:d,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:s,snappingManager:this.snappingManager,snapToScene:!1,view:t,...v};return t.type==="2d"?this._makeDrawGraphicTool2D(g):this._makeDrawGraphicTool3D(g)}async _makeDrawGraphicTool2D(e){const t=await this._requireModule(G(()=>import("./editingTools-DJ6HBL5e.js"),__vite__mapDeps([27,1,2,28,5,3,6,7,8,9,10,11,12,13,4,29,30,31,32,33,34,35,36,37,38,39,40,14,15,16,17,18,41,42,43,44,19,45,46,47,48,49,50,51,52]),import.meta.url));return E(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:ui(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(e){const t=await this._requireModule(G(()=>import("./ImageMaterial.glsl-Bw-3Bfrt.js").then(a=>a.e),__vite__mapDeps([53,1,2,51,4,31,3,32,11,33,10,12,34,35,36,5,6,7,8,9,13,37,38,39,40,14,15,16,17,18,54,55,56,57,43,58,59,60,61,62,63,64,65,66,67,47,68,69,70,42,71,72,46,73,74,75,76,77,41,78,79,80,81,82,83,84,29,30,44,19,45,85,86,87,88,48,89,90,91,92,49,50]),import.meta.url));if(E(t)||this.destroyed)return null;const{elevationInfo:i}=this.layer;return new t.module.DrawGraphicTool3D({...e,elevationInfo:i,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(e){const t=this.view;if(!t)return this._logMissingView(),null;let i=null;const a=e.forceUniformSize,o=e.centered,s=[t.on("key-down",r=>{if(r.key===b.pan)r.stopPropagation(),r.repeat||(e.enabled=!1);else if(r.key===b.complete)r.stopPropagation(),e.completeCreateOperation();else if(r.key!==b.vertexAdd||r.repeat)r.key===b.undo?(r.stopPropagation(),n.undo()):r.key===b.redo?(r.stopPropagation(),n.redo()):r.key!==b.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||r.repeat?r.key===b.center&&(r.repeat||(e.centered=!o,r.stopPropagation())):(e.forceUniformSize=!a,r.stopPropagation());else{const c=e.drawOperation.geometryType;c!=="polyline"&&c!=="polygon"&&c!=="multipoint"||(r.stopPropagation(),e.drawOperation.commitStagedVertex())}},w.WIDGET),t.on("key-up",r=>{r.key===b.pan?e.enabled=!0:r.key!==b.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?r.key===b.center&&(e.centered=o,r.stopPropagation()):(e.forceUniformSize=a,r.stopPropagation())},w.WIDGET),e.on("vertex-add",r=>{switch(i=i==null?"start":"active",r.operation){case"apply":this.emit("create",{graphic:e.graphic,state:i,tool:this.activeTool,toolEventInfo:r,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",r=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:r.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",r=>{switch(r.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:r,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",r=>{this._set("createGraphic",r.graphic),i="complete",r.aborted?n&&n.cancel():n&&n.complete()}),U(()=>this._getGraphicSymbolFromTool(e.geometryType),r=>{e.graphicSymbol=r})],n=new te({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{var r;R(s),(r=t.tools)==null||r.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return n}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":case"freehandPolyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":case"freehandPolygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,t){var n;const{layer:i,view:a}=this;if(!a)return this._logMissingView(),null;const o={...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t==null?void 0:t.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...t==null?void 0:t.highlightOptions}};let s=o.tool??Y.tool;for(const r of e)i.remove(r),i.add(r);if(a.type==="3d"){if(e.length===0)return null;switch(s){case"move":return this._setupMove3DOperation(e,o,a,s);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],o,a);case"transform":return this._setupGraphicTransform3DOperation(e,o,a)}}switch(s){case"move":return this._setupMove2DOperation(e,o,a);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,s,o,a);case"transform":if(e.length===1){const r=(n=e[0].geometry)==null?void 0:n.type;r!=="point"&&r!=="multipoint"||(s="reshape")}return this._setupTransformOrReshape2DOperation(e,s,o,a)}}async _setupMove3DOperation(e,t,i,a,o=!1){const s=await this._requireModule(G(()=>import("./ImageMaterial.glsl-Bw-3Bfrt.js").then(y=>y.e),__vite__mapDeps([53,1,2,51,4,31,3,32,11,33,10,12,34,35,36,5,6,7,8,9,13,37,38,39,40,14,15,16,17,18,54,55,56,57,43,58,59,60,61,62,63,64,65,66,67,47,68,69,70,42,71,72,46,73,74,75,76,77,41,78,79,80,81,82,83,84,29,30,44,19,45,85,86,87,88,48,89,90,91,92,49,50]),import.meta.url));if(E(s))return s;const{ManipulatedObject3DGraphic:n,MoveTool3D:r}=s.module,c=new Map,p=()=>{c.forEach(y=>y.destroy()),c.clear()};for(const y of e){const g=new n({view:i,graphic:y}),S=Yt(g);if(S!==_.SUPPORTED)return p(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${Ce(S)}).`),null;c.set(y,g)}const d=new r({view:i,enableZ:t.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(d),d.objects.addMany(Array.from(c.values())),o||this.updateGraphics.addMany(e);const l=[],v=new I({activeComponent:d,tool:a,type:"update",onEnd:()=>{R(l),X(i,d),p()},undo:()=>{xe(this.view,d),W(v,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:a})},redo:()=>{z(v,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:a})},addToSelection:y=>{this.updateGraphics.push(y);const g=new n({view:i,graphic:y});c.set(y,g),d.objects.push(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[y],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:y=>{const g=this.updateGraphics.indexOf(y);if(v.history.undo.forEach(M=>M.updates.splice(g,1)),v.history.redo.forEach(M=>M.updates.splice(g,1)),this.updateGraphics.remove(y),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[y],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void v.complete();const S=c.get(y);S&&(d.objects.remove(S),S.destroy(),c.delete(y))},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1||a!=="transform")return;const y=this.updateGraphics.at(0),g=await this._setupReshape3DOperation(y,t,i,!0);g&&!E(g)&&(v.onEnd(),v.destroy(),this._setUpdateOperationHandle(g,t))}});return l.push(...this._getHandlesForComponent(v,t),i.on("immediate-click",y=>this._getCommonUpdateOperationClickHandlers(v,y,t),w.WIDGET),i.on("key-down",y=>{this._getCommonUpdateOperationKeyDownHandlers(v,y)},w.WIDGET)),v}_setupGraphicTransform3DOperation(e,t,i,a=!1){if(e.length===1&&Kt(e[0])===_.SUPPORTED){const o=e[0],s=o.geometry;if(s!=null&&(s.type==="point"||s.type==="mesh"))return this._setupPointTransform3DOperation(o,t,i);if(s!=null&&(s.type==="polygon"||s.type==="polyline"))return this._setupPolyTransform3DOperation(o,t,i,a)}return this._setupMove3DOperation(e,t,i,"transform",a)}async _setupPointTransform3DOperation(e,t,i){const a="transform",{enableRotation:o,enableScaling:s,enableZ:n}=t,r=await this._requireModule(G(()=>import("./ImageMaterial.glsl-Bw-3Bfrt.js").then(g=>g.e),__vite__mapDeps([53,1,2,51,4,31,3,32,11,33,10,12,34,35,36,5,6,7,8,9,13,37,38,39,40,14,15,16,17,18,54,55,56,57,43,58,59,60,61,62,63,64,65,66,67,47,68,69,70,42,71,72,46,73,74,75,76,77,41,78,79,80,81,82,83,84,29,30,44,19,45,85,86,87,88,48,89,90,91,92,49,50]),import.meta.url));if(E(r))return r;const{TransformTool3D:c,ManipulatedObject3DGraphic:p}=r.module,d=new p({graphic:e,view:i}),l=new c({object:d,view:i,enableRotation:o,enableScaling:s,enableZ:n,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(l),this.updateGraphics.add(e);const v=[],y=new I({activeComponent:l,tool:a,type:"update",onEnd:()=>{R(v),X(i,l),d.destroy()},undo:()=>{xe(this.view,l),W(y,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:a})},redo:()=>{z(y,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:a})},addToSelection:async g=>{this.updateGraphics.add(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"}),y.onEnd(),y.destroy();const S=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);E(S)||this._setUpdateOperationHandle(S,t)},removeFromSelection:g=>{this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),y.complete()},toggleTool:()=>{}});return v.push(...this._getHandlesForComponent(y,t),i.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(y,g,t),w.WIDGET),i.on("key-down",g=>{this._getCommonUpdateOperationKeyDownHandlers(y,g)},w.WIDGET)),y}async _setupPolyTransform3DOperation(e,t,i,a=!1){var _e,fe;const o="transform",{enableRotation:s,enableScaling:n,enableZ:r,preserveAspectRatio:c}=t,p=await this._requireModule(G(()=>import("./ImageMaterial.glsl-Bw-3Bfrt.js").then(f=>f.e),__vite__mapDeps([53,1,2,51,4,31,3,32,11,33,10,12,34,35,36,5,6,7,8,9,13,37,38,39,40,14,15,16,17,18,54,55,56,57,43,58,59,60,61,62,63,64,65,66,67,47,68,69,70,42,71,72,46,73,74,75,76,77,41,78,79,80,81,82,83,84,29,30,44,19,45,85,86,87,88,48,89,90,91,92,49,50]),import.meta.url));if(E(p))return p;const{ManipulatedObject3DGraphic:d,ExtentTransformTool:l}=p.module,v=(fe=(_e=this.view)==null?void 0:_e.inputManager)==null?void 0:fe.isModifierKeyDown(b.constraint),y=new d({view:i,graphic:e}),g=new l({object:y,view:i,enableRotation:s,enableScaling:n,enableZ:r,preserveAspectRatio:!!c!=!!v,sketchOptions:this.sketchOptions});i.tools.add(g),a||this.updateGraphics.add(e);const S=[],M=new I({activeComponent:g,tool:o,type:"update",onEnd:()=>{R(S),X(i,g),y.destroy()},canUndo:()=>!g.destroyed&&g.canUndo,undo:()=>{g.destroyed||(g.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},canRedo:()=>!g.destroyed&&g.canRedo,redo:()=>{g.destroyed||(g.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},addToSelection:async f=>{this.updateGraphics.add(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[f],removed:[],type:"selection-change"},type:"update"}),M.onEnd(),M.destroy();const be=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);E(be)||this._setUpdateOperationHandle(be,t)},removeFromSelection:f=>{this.updateGraphics.remove(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[f],type:"selection-change"},type:"update"}),M.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1)return;const f=await this._setupReshape3DOperation(e,t,i,!0);f&&!E(f)&&(M.onEnd(),M.destroy(),this._setUpdateOperationHandle(f,t))}});return S.push(...this._getHandlesForComponent(M,t),i.on("immediate-click",f=>this._getCommonUpdateOperationClickHandlers(M,f,t),w.WIDGET),i.on("key-down",f=>this._getCommonUpdateOperationKeyDownHandlers(M,f),w.WIDGET),i.on("key-down",f=>{f.key!==b.constraint||f.repeat||(g.preserveAspectRatio=!g.preserveAspectRatio,f.stopPropagation())},w.WIDGET),i.on("key-up",f=>{f.key===b.constraint&&(g.preserveAspectRatio=!g.preserveAspectRatio,f.stopPropagation())},w.WIDGET)),M}async _setupMove2DOperation(e,t,i){const a="move";this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o=await this._getGraphicMover(e,t,i);if(E(o))return o;const s=new I({activeComponent:o,tool:a,type:"update",onEnd:()=>{var p;this._displayDefaultCursor(),R(c),R(r),o.destroy(),(p=this._internalGraphicsLayer)==null||p.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const p=this.updateGraphics.toArray();W(s,p),s.refreshComponent(),this._emitUndoEvent({graphics:p,tool:a})},redo:()=>{const p=this.updateGraphics.toArray();z(s,p),s.refreshComponent(),this._emitRedoEvent({graphics:p,tool:a})},addToSelection:async p=>{await this._updatingHandles.addPromise(this._updateSpatialReference(p)),this.updateGraphics.push(p),o.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[p],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:p=>{const d=this.updateGraphics.indexOf(p);s.history.undo.forEach(v=>v.updates.splice(d,1)),s.history.redo.forEach(v=>v.updates.splice(d,1)),this.updateGraphics.remove(p);const l=this.updateGraphics.toArray();this.emit("update",{graphics:l,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[p],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?o.graphics=l:s.complete()}});let n=!1;const r=[i.on("immediate-click",p=>this._getCommonUpdateOperationClickHandlers(s,p,t),w.WIDGET),i.on("key-down",p=>{this._getCommonUpdateOperationKeyDownHandlers(s,p),p.key!==b.constraint||p.repeat||(n=!0,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},w.WIDGET),i.on("key-up",p=>{p.key===b.constraint&&n&&(n=!1,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},w.WIDGET)],c=this._getHandlesForComponent(s,t);return s}async _setupReshape3DOperation(e,t,i,a=!1){const o="reshape",s=await this._requireModule(G(()=>import("./ImageMaterial.glsl-Bw-3Bfrt.js").then(g=>g.e),__vite__mapDeps([53,1,2,51,4,31,3,32,11,33,10,12,34,35,36,5,6,7,8,9,13,37,38,39,40,14,15,16,17,18,54,55,56,57,43,58,59,60,61,62,63,64,65,66,67,47,68,69,70,42,71,72,46,73,74,75,76,77,41,78,79,80,81,82,83,84,29,30,44,19,45,85,86,87,88,48,89,90,91,92,49,50]),import.meta.url));if(E(s))return s;const{ManipulatedObject3DGraphic:n,ReshapeTool3D:r}=s.module,c=new n({view:i,graphic:e}),p=Bt(c);if(p!==_.SUPPORTED)return c.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${Ce(p)}).`),null;const d=t.reshapeOptions,l=new r({view:i,object:c,enableZVertex:t.enableZ&&(d==null?void 0:d.vertexOperation)==="move",enableZShape:t.enableZ&&(d==null?void 0:d.shapeOperation)==="move",enableMoveObject:(d==null?void 0:d.shapeOperation)==="move"||(d==null?void 0:d.shapeOperation)==="move-xy",enableMidpoints:(d==null?void 0:d.edgeOperation)==="split",enableEdgeOffset:(d==null?void 0:d.edgeOperation)==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(l),a||this.updateGraphics.add(c.graphic);const v=[],y=new I({activeComponent:l,tool:o,type:"update",onEnd:()=>{R(v),X(i,l),c.destroy()},canUndo:()=>!l.destroyed&&l.canUndo,undo:()=>{l.destroyed||(l.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},canRedo:()=>!l.destroyed&&l.canRedo,redo:()=>{l.destroyed||(l.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},addToSelection:async g=>{this.updateGraphics.add(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"}),y.onEnd(),y.destroy();const S=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);E(S)||this._setUpdateOperationHandle(S,t)},removeFromSelection:g=>{this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),y.complete()},toggleTool:async()=>{if(t.toggleToolOnClick===!1)return;y.onEnd(),y.destroy();const g=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,i,!0);E(g)||this._setUpdateOperationHandle(g,t)}});return v.push(...this._getHandlesForComponent(y,t),i.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(y,g,t),w.WIDGET),i.on("key-down",g=>{this._getCommonUpdateOperationKeyDownHandlers(y,g)},w.WIDGET)),y}async _setupTransformOrReshape2DOperation(e,t,i,a){this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o=t==="transform"?await this._getBox(e,i,a):await this._getReshape(e,i,a);if(E(o))return o;const s=new I({activeComponent:o,type:"update",onEnd:()=>{R(r),R(n),s.activeComponent&&!s.activeComponent.destroyed&&s.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{W(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},redo:()=>{z(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},addToSelection:async c=>{let p=s.activeComponent;if((p==null?void 0:p.type)==="reshape"){const d=[...this.updateGraphics,c];this.updateGraphics.removeAll(),s.onEnd(),s.destroy();const l=await this._setupTransformOrReshape2DOperation(d,"transform",i,a);if(E(l))return;this._setUpdateOperationHandle(l,i)}else this.updateGraphics.add(c),p.graphics=this.updateGraphics.toArray(),p.refresh(),s.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[c],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async c=>{const p=this.updateGraphics.indexOf(c);s.history.undo.forEach(l=>l.updates.splice(p,1)),s.history.redo.forEach(l=>l.updates.splice(p,1)),this.updateGraphics.remove(c);const d=this.updateGraphics.toArray();if(d.length===0)s.complete();else{const l=d[0].geometry;d.length!==1||l==null||l.type!=="point"&&l.type!=="multipoint"?s.activeComponent.graphics=d:s.toggleTool()}this.emit("update",{graphics:d,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[c],type:"selection-change"},type:"update"})},toggleTool:async()=>{var l;if(this.updateGraphics.length>1)return;const c=this.updateGraphics.at(0),p=c.geometry;if(p!=null&&(s.tool==="reshape"&&(p.type==="point"||p.type==="multipoint")||s.tool==="transform"&&p.type==="extent"))return;let d=null;s.tool==="transform"?d=await this._getReshape([c],i,a):s.tool==="reshape"&&(d=await this._getBox([c],i,a)),E(d)||((l=s.activeComponent)==null||l.destroy(),s.activeComponent=d,s.activeComponent&&(R(r),r=this._getHandlesForComponent(s,i)))}}),n=[a.on("immediate-click",c=>this._getCommonUpdateOperationClickHandlers(s,c,i),w.WIDGET),a.on("key-down",c=>{if(this._getCommonUpdateOperationKeyDownHandlers(s,c),c.key===b.constraint&&!c.repeat&&s){const p=s.activeComponent;p&&p.type==="box"&&(p.preserveAspectRatio=!p.preserveAspectRatio)}},w.WIDGET),a.on("key-up",c=>{if(c.key===b.constraint&&s){const p=s.activeComponent;p&&p.type==="box"&&(p.preserveAspectRatio=!p.preserveAspectRatio)}},w.WIDGET)];let r=this._getHandlesForComponent(s,i);return s}async _getGraphicMover(e,t,i){const{enableMoveAllGraphics:a,highlightOptions:o}=t,s=await this._requireModule(G(()=>import("./GraphicMover-CwCSePV7.js").then(n=>n.G),__vite__mapDeps([109,1,2,19,52,26,110,111,49,7,4,50]),import.meta.url));return E(s)?s:new s.module.default({enableMoveAllGraphics:a,highlightsEnabled:!!(o!=null&&o.enabled),indicatorsEnabled:!1,graphics:e,view:i,callbacks:{onGraphicMoveStart:({dx:n,dy:r,graphic:c})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:n,dy:r,mover:c,type:"move-start"},type:"update"})},onGraphicMove:({dx:n,dy:r,graphic:c})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:n,dy:r,mover:c,type:"move"},type:"update"}),onGraphicMoveStop:({dx:n,dy:r,graphic:c})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:n,dy:r,mover:c,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,i){var p,d;const{enableRotation:a,enableScaling:o,highlightOptions:s,preserveAspectRatio:n}=t,r=await this._requireModule(G(()=>import("./Box-CJvycJtF.js"),__vite__mapDeps([112,1,2,3,52,109,19,26,110,111,49,7,4,50,113,5,6,8,9,10,11,12,13,31,32,33,34,35,36,37,38,39,40,14,15,16,17,18,92,87,20,21]),import.meta.url));if(E(r))return r;const c=(d=(p=this.view)==null?void 0:p.inputManager)==null?void 0:d.isModifierKeyDown(b.constraint);return new r.module.default({graphics:e,enableRotation:a,enableScaling:o,highlightsEnabled:!!(s!=null&&s.enabled),preserveAspectRatio:!!n!=!!c,layer:this._internalGraphicsLayer,view:i,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMove:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMoveStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScale:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotate:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"})}})}async _getReshape(e,t,i){var r,c,p;const a=((r=t.reshapeOptions)==null?void 0:r.edgeOperation)==="split",o=((c=t.reshapeOptions)==null?void 0:c.shapeOperation)==="move",s=!!((p=t.highlightOptions)!=null&&p.enabled),n=await this._requireModule(G(()=>import("./Reshape-Cf6ieFRv.js"),__vite__mapDeps([114,1,2,19,28,5,3,6,7,8,9,10,11,12,13,4,29,30,31,32,33,34,35,36,37,38,39,40,14,15,16,17,18,41,42,43,52,109,26,110,111,49,50,86,87,113,20,21]),import.meta.url));return E(n)?n:new n.module.default({enableMidpoints:a,enableMovement:o,graphic:e[0],highlightsEnabled:s,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:i,callbacks:{onReshapeStart:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onReshape:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onReshapeStop:({mover:d,type:l})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d,type:l},type:"update"}),onMoveStart:({dx:d,dy:l,mover:v,type:y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:l,mover:v,type:y},type:"update"}),onMove:({dx:d,dy:l,mover:v,type:y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:l,mover:v,type:y},type:"update"}),onMoveStop:({dx:d,dy:l,mover:v,type:y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:l,mover:v,type:y},type:"update"}),onVertexAdd:({added:d,type:l,vertices:v})=>{const y=d.map(g=>Oe(g.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:y,vertices:v,type:l},type:"update"})},onVertexRemove:({removed:d,type:l,vertices:v})=>{const y=d.map(g=>Oe(g.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:y,vertices:v,type:l},type:"update"})}}})}_getHandlesForComponent(e,t){const i=e.activeComponent;if(!i)return[];switch(i.type){case"graphic-mover":return[i.on("graphic-click",({graphic:a,viewEvent:o})=>{var s;(s=o.native)!=null&&s.shiftKey&&(o.stopPropagation(),e.removeFromSelection(a))}),i.on("graphic-move-start",a=>e.addToHistory(H(a.allGraphics)))];case"box":return[i.on("graphic-click",a=>this._onTransformOrReshape2DGraphicClick(e,t,a)),i.on("move-start",a=>e.addToHistory(H(a.graphics))),i.on("rotate-start",a=>e.addToHistory(H(a.graphics))),i.on("scale-start",a=>e.addToHistory(H(a.graphics)))];case"reshape":return[i.on("graphic-click",a=>this._onTransformOrReshape2DGraphicClick(e,t,a)),i.on("move-start",a=>e.addToHistory(H([a.mover]))),i.on("reshape-start",a=>e.addToHistory(H([a.graphic]))),i.on("vertex-add",a=>e.addToHistory(H([a.oldGraphic]))),i.on("vertex-remove",a=>e.addToHistory(H([a.oldGraphic])))];case"move-3d":return[i.events.on("record-undo",({updates:a})=>{e.addToHistory({updates:a})}),i.events.on("move-start",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:a.objects.length>0?a.objects[0].graphic:null,type:"move-start"},type:"update"})}),i.events.on("move",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a.dx,dy:a.dy,mover:a.objects.length>0?a.objects[0].graphic:null,type:"move"},type:"update"})}),i.events.on("move-stop",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:a.objects.length>0?a.objects[0].graphic:null,type:"move-stop"},type:"update"})}),i.events.on("immediate-click",a=>{a.shiftKey?this._toggleSelection([a.object.graphic],e,t):e.toggleTool()})];case"transform-3d":return[i.events.on("record-undo",({updates:a})=>{e.addToHistory({updates:a})}),i.events.on("translate-start",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,dx:a.dxScreen,dy:a.dyScreen,type:"move-start"},type:"update"})}),i.events.on("translate-stop",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,dx:a.dxScreen,dy:a.dyScreen,type:"move-stop"},type:"update"})}),i.events.on("rotate-start",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,angle:a.angle,type:"rotate-start"},type:"update"})}),i.events.on("rotate-stop",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,angle:a.angle,type:"rotate-stop"},type:"update"})}),i.events.on("scale-start",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,xScale:a.xScale,yScale:a.yScale,type:"scale-start"},type:"update"})}),i.events.on("scale-stop",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,xScale:a.xScale,yScale:a.yScale,type:"scale-stop"},type:"update"})}),i.events.on("translate",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,dx:a.dxScreen,dy:a.dyScreen,type:"move"},type:"update"})}),i.events.on("rotate",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,angle:a.angle,type:"rotate"},type:"update"})}),i.events.on("scale",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,xScale:a.xScale,yScale:a.yScale,type:"scale"},type:"update"})}),i.events.on("immediate-click",a=>{a.shiftKey?this._toggleSelection([a.object.graphic],e,t):e.toggleTool()})];case"reshape-3d":return[i.events.on("reshape",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...a,mover:a.object.graphic},type:"update"})}),i.events.on("move",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...a,mover:a.object.graphic},type:"update"})}),i.events.on("vertex-add",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:a,type:"update"})}),i.events.on("vertex-remove",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:a,type:"update"})}),i.events.on("immediate-click",a=>{a.shiftKey?this._toggleSelection([a.object.graphic],e,t):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,t,i){var s;const{graphic:a,viewEvent:o}=i;return(s=o.native)!=null&&s.shiftKey&&a.layer===this.layer?(o.stopPropagation(),e.removeFromSelection(a)):t.toggleToolOnClick?(o.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){var o;this._operationHandle=e;const i=(o=this.view)==null?void 0:o.map;this._disablePopup(t);const a=()=>{if(e===this._operationHandle){const s=this.updateGraphics.toArray(),n=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),i&&i.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:s,state:"complete",aborted:e.cancelled,tool:n,toolEventInfo:null,type:"update"})}};e.on("complete",a)}async _getCommonUpdateOperationClickHandlers(e,t,i){const a=Te(t),o=await t.async(()=>this._getFirstHit(a));if(o==null)return void e.complete();if(t.native.shiftKey&&this._toggleSelection([o.graphic],e,i))return void t.stopPropagation();this.updateGraphics.includes(o.graphic)?t.stopPropagation():e.complete()}_toggleSelection(e,t,i){const a=!!i.multipleSelectionEnabled;return e.some(o=>o!=null&&!(!a||o.layer!==this.layer)&&(this.updateGraphics.includes(o)?t.removeFromSelection(o):t.addToSelection(o),!0))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const i=t.key;i===b.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):i===b.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):i===b.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&b.delete.includes(i)&&this._onDeleteKey(t)}_onDeleteKey(e){var a;if(!this._operationHandle||this._operationHandle.type!=="update")return;const t=this.activeComponent,i=this.updateGraphics.toArray();t!=null&&(t.type!=="reshape"||i.length===1&&((a=i[0].geometry)==null?void 0:a.type)==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){var e,t;this._internalGraphicsLayer&&((t=(e=this.view)==null?void 0:e.map)==null||t.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=F(this._internalGraphicsLayer))}_isComponentGraphic(e){var i;const{activeComponent:t}=this;return!(!e||t==null)&&(((i=e.attributes)==null?void 0:i.esriSketchTool)||t.type==="draw-2d"&&t.graphic===e||(t.type==="box"||t.type==="reshape")&&t.isUIGraphic(e))}_displayPointerCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,t,i){Ue.getLogger(this).error(new bt(e,t,i))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const i=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:i}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){}wait(){return Ge(()=>!this.updating)}_disablePopupEnabled(e){var t;return((t=this.view)==null?void 0:t.type)!=="3d"||this.updateOnGraphicClick||((e==null?void 0:e.toggleToolOnClick)??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(pe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await Et(Ge(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",Le("view"))}_logMissingLayer(){this._logError(di,Le("layer"))}};h([u()],m.prototype,"_defaultSnappingManager",void 0),h([u()],m.prototype,"updating",null),h([u({readOnly:!0})],m.prototype,"_updatingHandles",void 0),h([u()],m.prototype,"_operationHandle",void 0),h([u({readOnly:!0})],m.prototype,"activeTool",null),h([u({readOnly:!0})],m.prototype,"activeCreateToolDrawMode",null),h([u()],m.prototype,"activeTooltip",null),h([u({types:q})],m.prototype,"activeFillSymbol",void 0),h([u()],m.prototype,"activeLineSymbol",void 0),h([u()],m.prototype,"activeVertexSymbol",void 0),h([u()],m.prototype,"allowDeleteKey",void 0),h([u({readOnly:!0})],m.prototype,"createGraphic",null),h([u()],m.prototype,"defaultCreateOptions",null),h([u()],m.prototype,"defaultUpdateOptions",null),h([u({type:Ft,nonNullable:!0})],m.prototype,"labelOptions",null),h([u()],m.prototype,"layer",void 0),h([u({types:q})],m.prototype,"pointSymbol",void 0),h([u({types:q})],m.prototype,"polygonSymbol",void 0),h([u({types:q})],m.prototype,"polylineSymbol",void 0),h([u()],m.prototype,"meshSymbol",void 0),h([u({type:me,nonNullable:!0})],m.prototype,"snappingOptions",null),h([u()],m.prototype,"snappingManager",null),h([u({readOnly:!0})],m.prototype,"state",null),h([u({type:Nt,nonNullable:!0})],m.prototype,"tooltipOptions",null),h([u({readOnly:!0})],m.prototype,"updateGraphics",void 0),h([u()],m.prototype,"updateOnGraphicClick",void 0),h([u()],m.prototype,"creationMode",void 0),h([u({type:jt,nonNullable:!0})],m.prototype,"valueOptions",null),h([u({types:q})],m.prototype,"vertexSymbol",void 0),h([u({value:null})],m.prototype,"view",null),h([u({constructOnly:!0,type:Ye})],m.prototype,"sketchOptions",void 0),m=h([V("esri.widgets.Sketch.SketchViewModel")],m);const di="sketch:missing-property",Le=e=>`Property '${e}' is missing on SketchViewModel.`;function ui(e){return e==="polygon"||e==="rectangle"||e==="circle"}function W(e,t){Ke("undo",e.history.undo,e.history.redo,t)}function z(e,t){Ke("redo",e.history.redo,e.history.undo,t)}function Ke(e,t,i,a){const o=t.pop();if(!o)return;const s=o.updates,n=[];a.forEach((r,c)=>{const p=s[c];p!=null&&("geometry"in p&&p.geometry!=null&&(n.push({geometry:r.geometry}),r.geometry=p.geometry),"symbol"in p&&p.symbol!=null&&(n.push({symbol:r.symbol}),r.symbol=p.symbol),"undo"in p&&(n.push(p),p[e](r)))}),i.push({updates:n})}function xe(e,t){e!=null&&t.hasGrabbedManipulators&&(e.activeTool=null)}function H(e){return{updates:e.map(({geometry:t})=>(t==null?void 0:t.type)==="mesh"?{geometry:t.cloneShallow()}:{geometry:t})}}function X(e,t){var i;(i=e.tools)==null||i.remove(t),t.destroyed||t.destroy()}function E(e){return"requireError"in e&&e.requireError==="aborted"}const yi=m;function J(e,t){e.networkFeature=t}function gi(e){const t=N(e.graphic);return{...e,networkFeature:t}}function vi(e){const t=e.graphics.map(i=>N(i));return{...e,networkFeatures:t}}function N(e){return e.networkFeature}function mi(e){return(e==null?void 0:e.type)==="point"||(e==null?void 0:e.type)==="polyline"||(e==null?void 0:e.type)==="polygon"}let x=class extends se{constructor(e){super(e),this._createMode=null,this._graphicsLayer=new $e({internal:!0,listMode:"hide",title:"Banana"}),this._updatingHandles=new Ve,this.enabled=!0,this._handleSketchViewModelEvents=async t=>{var i,a;switch(t.type){case"update":switch(t.state){case"active":case"complete":for(const o of t.graphics)N(o).geometry=mi(o.geometry)?o.geometry.clone():null}break;case"undo":case"redo":break;case"delete":for(const o of t.graphics){const s=N(o);this._removeNetworkFeature(s)}break;case"create":if(t.graphic&&t.state==="complete"&&this._createMode){const o=(i=t.graphic.geometry)==null?void 0:i.clone(),s=(a=t.graphic.symbol)==null?void 0:a.clone();if(!o)break;switch(this._createMode){case"stop":{if(o.type!=="point")break;const{stops:n}=this.layer;if(n.length>0&&n.every(({geometry:c})=>!c)){n.at(0).geometry=o;break}if(n.length>1&&n.filter((c,p)=>p!==0).every(({geometry:c})=>!c)){n.at(1).geometry=o;break}const r=new Mt({geometry:o});n.add(r),J(t.graphic,r);break}case"point-barrier":{if(o.type!=="point")break;const n=new Gt({geometry:o,symbol:s});this.layer.pointBarriers.add(n),J(t.graphic,n);break}case"polyline-barrier":{if(o.type!=="polyline")break;const n=new Ot({geometry:o,symbol:s});this.layer.polylineBarriers.add(n),J(t.graphic,n);break}case"polygon-barrier":{if(o.type!=="polygon")break;const n=new Tt({geometry:o,symbol:s});this.layer.polygonBarriers.add(n),J(t.graphic,n);break}}}}(await this.view.whenLayerView(this.layer)).emit(t.type,t.type==="create"?gi(t):vi(t))}}initialize(){this._sketchViewModel=new yi({layer:this._graphicsLayer,view:this.view}),this.addHandles([U(()=>this.enabled,e=>{e?this._activate():this._deactivate()},wt),U(()=>{const{stops:e,pointBarriers:t,polylineBarriers:i,polygonBarriers:a}=this.layer;return{stops:e,pointBarriers:t,polylineBarriers:i,polygonBarriers:a}},()=>{this.enabled&&this._loadClonedGraphics()}),this._sketchViewModel.on(["create","delete","redo","undo","update"],this._handleSketchViewModelEvents),St(this._updatingHandles)])}destroy(){this.view.map.remove(this._graphicsLayer),this._graphicsLayer.removeAll(),this._graphicsLayer=F(this._graphicsLayer),this._sketchViewModel=F(this._sketchViewModel)}get selectedNetworkFeatures(){return this._sketchViewModel.updateGraphics.map(e=>N(e))}get updating(){return this._updatingHandles.updating}create(e){var t;switch(this._createMode=e,e){case"stop":(t=this.layer.defaultSymbols.stops)!=null&&t.unlocated&&(this._sketchViewModel.pointSymbol=this.layer.defaultSymbols.stops.unlocated.clone());break;case"point-barrier":this.layer.defaultSymbols.pointBarriers&&(this._sketchViewModel.pointSymbol=this.layer.defaultSymbols.pointBarriers.clone());break;case"polyline-barrier":this.layer.defaultSymbols.polylineBarriers&&(this._sketchViewModel.polylineSymbol=this.layer.defaultSymbols.polylineBarriers.clone());break;case"polygon-barrier":this.layer.defaultSymbols.polygonBarriers&&(this._sketchViewModel.polygonSymbol=this.layer.defaultSymbols.polygonBarriers.clone())}switch(e){case"stop":case"point-barrier":return this._sketchViewModel.create("point");case"polyline-barrier":return this._sketchViewModel.create("polyline");case"polygon-barrier":return this._sketchViewModel.create("polygon")}}remove(e){const t=this._graphicsLayer.graphics.find(i=>N(i)===e);t&&this._graphicsLayer.remove(t),this._removeNetworkFeature(e)}_activate(){this._loadClonedGraphics(),this.view.map.add(this._graphicsLayer)}_deactivate(){var e;this._sketchViewModel.cancel(),(e=this.view.map)==null||e.remove(this._graphicsLayer),this._graphicsLayer.removeAll()}_loadClonedGraphics(){const e=[this.layer.stops,this.layer.pointBarriers,this.layer.polylineBarriers,this.layer.polygonBarriers].flatMap(t=>t.toArray().map(i=>{const a=i.toGraphic();return a.networkFeature=i,a}));this._graphicsLayer.removeAll().addMany(e)}_removeNetworkFeature(e){switch(e.type){case"stop":this.layer.stops.remove(e);break;case"point-barrier":this.layer.pointBarriers.remove(e);break;case"polyline-barrier":this.layer.polylineBarriers.remove(e);break;case"polygon-barrier":this.layer.polygonBarriers.remove(e)}}};h([u()],x.prototype,"enabled",void 0),h([u({constructOnly:!0})],x.prototype,"layer",void 0),h([u({readOnly:!0})],x.prototype,"selectedNetworkFeatures",null),h([u()],x.prototype,"updating",null),h([u({constructOnly:!0})],x.prototype,"view",void 0),x=h([V("esri.views.2d.layers.support.RouteLayerInteraction")],x);const Hi=Object.freeze(Object.defineProperty({__proto__:null,get RouteLayerInteraction(){return x}},Symbol.toStringTag,{value:"Module"}));export{_ as P,Hi as R,ee as a,Xt as b,Jt as c,ti as d,ke as e,Ti as f,ei as g,ii as h,ai as i,Yt as j,Ze as n,ae as o,oe as p,Qt as r,si as s};
