import{b as T,en as f,ak as U,nA as N,el as P,eq as x,bD as o}from"./index-Cf67L9ml.js";import"./Program-Dg5lKghI.js";import{t as L}from"./VertexElementDescriptor-BOD-G50G.js";import{i as R}from"./BoundingBox-CUQpoh07.js";let p=class E{constructor(t,n,r,i,s,a,c){this.instanceId=t,this.textureKey=n,this.indexStart=r,this.indexCount=i,this.vertexStart=s,this.vertexCount=a,this.overlaps=c}updateBaseOffsets(t){this.vertexStart+=t.vertexFrom,this.indexStart+=t.indexFrom}clone(){return new E(this.instanceId,this.textureKey,this.indexStart,this.indexCount,this.vertexStart,this.vertexCount,this.overlaps)}static write(t,n,r,i,s,a,c,u){t.push(n),t.push(r),t.push(i),t.push(s),t.push(a),t.push(c),t.push(u)}serialize(t){return t.push(this.instanceId),t.push(this.textureKey),t.push(this.indexStart),t.push(this.indexCount),t.push(this.vertexStart),t.push(this.vertexCount),t.push(this.overlaps),t}static deserialize(t){const n=t.readInt32(),r=t.readInt32(),i=t.readInt32(),s=t.readInt32(),a=t.readInt32(),c=t.readInt32(),u=t.readInt32();return new E(n,r,i,s,a,c,u)}};p.byteSizeHint=7*Uint32Array.BYTES_PER_ELEMENT;function y(e,t){if(t!==null){e.push(t.length);for(const n of t)n.serialize(e);return e}e.push(0)}function I(e,t,n){const r=e.readInt32(),i=new Array(r);for(let s=0;s<i.length;s++)i[s]=t.deserialize(e,n);return i}let Y=class M{constructor(t,n){this.id=t,this.sortKey=n,this.records=[]}serialize(t){return t.push(this.id),t.writeF32(this.sortKey),y(t,this.records),t}static deserialize(t){const n=t.readInt32(),r=t.readF32(),i=new M(n,r);return i.records=I(t,p)??[],i}};Y.byteSizeHint=2*Uint32Array.BYTES_PER_ELEMENT+p.byteSizeHint;const S=()=>U.getLogger("esri.views.2d.engine.webgl.Utils");function G(e){switch(e){case f.UNSIGNED_BYTE:return 1;case f.UNSIGNED_SHORT_4_4_4_4:return 2;case f.FLOAT:return 4;default:return void S().error(new T("webgl-utils",`Unable to handle type ${e}`))}}function X(e){switch(e){case f.UNSIGNED_BYTE:return Uint8Array;case f.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case f.FLOAT:return Float32Array;default:return void S().error(new T("webgl-utils",`Unable to handle type ${e}`))}}function b(e){const t=new Map;for(const n in e){const r=e[n];let i=0;t.set(n,r.map(s=>{const a=new L(s.name,s.count,s.type,i,0,s.normalized||!1);return i+=s.count*N(s.type),a})),t.get(n).forEach(s=>s.stride=i)}return t}const B=e=>{const t=new Map;for(const n in e)for(const r of e[n])t.set(r.name,r.location);return t},$=e=>{const t={};return e.forEach((n,r)=>t[r]=n!=null&&n.length?n[0].stride:0),t},h=new Map,K=(e,t)=>{if(!h.has(e)){const n=b(t),r={strides:$(n),bufferLayouts:n,attributes:B(t)};h.set(e,r)}return h.get(e)},q=e=>e.includes("data:image/svg+xml");function V(e){const t=[];for(let n=0;n<e.length;n++)t.push(e.charCodeAt(n));return t}function J(e,t,n){const r=new P(t.width,t.height);return r.dataType=t.dataType,t.depth&&(r.depth=t.depth),t.flipped&&(r.flipped=t.flipped),t.hasMipmap&&(r.hasMipmap=t.hasMipmap),r.internalFormat=t.internalFormat,t.isImmutable&&(r.isImmutable=t.isImmutable),t.isOpaque&&(r.isOpaque=t.isOpaque),t.maxAnisotropy&&(r.maxAnisotropy=t.maxAnisotropy),r.pixelFormat=t.pixelFormat,t.preMultiplyAlpha&&(r.preMultiplyAlpha=t.preMultiplyAlpha),t.samplingMode&&(r.samplingMode=t.samplingMode),t.target&&(r.target=t.target),r.uniform=t.uniform,t.unpackAlignment&&(r.unpackAlignment=t.unpackAlignment),t.wrapMode&&(r.wrapMode=t.wrapMode),new x(e,r,n)}function j(e){return"url"in e&&"urlHash"in e?{...e,url:""}:e}function Q(e){if(e==null)return"";const{type:t}=e;switch(t){case"CIMMarkerPlacementAlongLineRandomSize":return`${t}-${e.seed}-${e.randomization}`;case"CIMMarkerPlacementAlongLineVariableSize":return`${t}-${e.maxRandomOffset}-${e.numberOfSizes}-${e.seed}-${e.variationMethod}`;case"CIMMarkerPlacementAtExtremities":return`${t}-${e.extremityPlacement}-${e.offsetAlongLine}`;case"CIMMarkerPlacementAtRatioPositions":return`${t}-${e.beginPosition}-${e.endPosition}-${e.flipFirst}-${JSON.stringify(e.positionArray)}`;case"CIMMarkerPlacementAtMeasuredUnits":return`${t}-${e.interval}-${e.skipMarkerRate}-${e.placeAtExtremities}`;case"CIMMarkerPlacementInsidePolygon":return`${t}-${e.stepX}-${e.stepY}-${e.randomness}-${e.gridType}-${e.seed}-${e.shiftOddRows}`;case"CIMMarkerPlacementOnLine":return`${t}-${e.relativeTo}-${e.startPointOffset}`;case"CIMMarkerPlacementOnVertices":return`${t}-${e.placeOnControlPoints}-${e.placeOnEndPoints}-${e.placeOnRegularVertices}`;case"CIMMarkerPlacementPolygonCenter":return`${t}-${e.method}`;default:return`${t}`}}const A=new Float32Array(1),O=new Uint32Array(A.buffer);function k(e){return A[0]=e,O[0]}function W(e,t){return 65535&e|t<<16}function d(e){const t=k(e),n=t>>>31;let r=t>>>23&255,i=8388607&t;return r-=127,r>15?n<<15|31744:r<-25?0:(r<-14&&(i+=8388608,i/=2**(-14-r),r=-15),r+=15,i/=8192,i=C(i,1023),n<<15|r<<10|i)}function C(e,t){const n=Math.floor(e),r=e-n;return n<t&&(r>.5||r===.5&&n%2==1)?n+1:n}function m(e){let t=e>>>15,n=e>>10&31,r=1023&e;return t=t?-1:1,n-=15,r/=1024,n>-15?r+=1:n=-14,t*2**n*r}function Z(e,t,n,r){const i=n.packPrecisionFactor??1;switch(n.type){case o.BYTE:if(n.count===1)e.setInt8(r+n.offset,t*i);else for(let s=0;s<n.count;s++){const a=s*Int8Array.BYTES_PER_ELEMENT;e.setInt8(r+n.offset+a,t[s]*i)}break;case o.UNSIGNED_BYTE:if(n.count===1)e.setUint8(r+n.offset,t*i);else for(let s=0;s<n.count;s++){const a=s*Uint8Array.BYTES_PER_ELEMENT;e.setUint8(r+n.offset+a,t[s]*i)}break;case o.SHORT:if(n.count===1)e.setInt16(r+n.offset,t*i,!0);else for(let s=0;s<n.count;s++){const a=s*Int16Array.BYTES_PER_ELEMENT;e.setInt16(r+n.offset+a,t[s]*i,!0)}break;case o.UNSIGNED_SHORT:if(n.count===1)e.setUint16(r+n.offset,t*i,!0);else for(let s=0;s<n.count;s++){const a=s*Uint16Array.BYTES_PER_ELEMENT;e.setUint16(r+n.offset+a,t[s]*i,!0)}break;case o.INT:if(n.count===1)e.setInt32(r+n.offset,t*i,!0);else for(let s=0;s<n.count;s++){const a=s*Int32Array.BYTES_PER_ELEMENT;e.setInt32(r+n.offset+a,t[s]*i,!0)}break;case o.UNSIGNED_INT:if(n.count===1)e.setUint32(r+n.offset,t*i,!0);else for(let s=0;s<n.count;s++){const a=s*Uint32Array.BYTES_PER_ELEMENT;e.setUint32(r+n.offset+a,t[s]*i,!0)}break;case o.FLOAT:if(n.count===1)e.setFloat32(r+n.offset,t*i,!0);else for(let s=0;s<n.count;s++){const a=s*Float32Array.BYTES_PER_ELEMENT;e.setFloat32(r+n.offset+a,t[s]*i,!0)}break;case o.HALF_FLOAT:if(n.count===1)e.setUint16(r+n.offset,d(t*i),!0);else for(let s=0;s<n.count;s++){const a=s*Uint16Array.BYTES_PER_ELEMENT;e.setUint16(r+n.offset+a,d(t[s]*i),!0)}}}function tt(e,t,n){switch(t.type){case o.BYTE:{if(t.count===1)return e.getInt8(n+t.offset);const r=[];for(let i=0;i<t.count;i++){const s=i*Int8Array.BYTES_PER_ELEMENT;r.push(e.getInt8(n+t.offset+s))}return r}case o.UNSIGNED_BYTE:{if(t.count===1)return e.getUint8(n+t.offset);const r=[];for(let i=0;i<t.count;i++){const s=i*Uint8Array.BYTES_PER_ELEMENT;r.push(e.getUint8(n+t.offset+s))}return r}case o.SHORT:{if(t.count===1)return e.getInt16(n+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const s=i*Int16Array.BYTES_PER_ELEMENT;r.push(e.getInt16(n+t.offset+s,!0))}return r}case o.UNSIGNED_SHORT:{if(t.count===1)return e.getUint16(n+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const s=i*Uint16Array.BYTES_PER_ELEMENT;r.push(e.getUint16(n+t.offset+s,!0))}return r}case o.INT:{if(t.count===1)return e.getInt32(n+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const s=i*Int32Array.BYTES_PER_ELEMENT;r.push(e.getInt32(n+t.offset+s,!0))}return r}case o.UNSIGNED_INT:{if(t.count===1)return e.getUint32(n+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const s=i*Uint32Array.BYTES_PER_ELEMENT;r.push(e.getUint32(n+t.offset+s,!0))}return r}case o.FLOAT:{if(t.count===1)return e.getFloat32(n+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const s=i*Float32Array.BYTES_PER_ELEMENT;r.push(e.getFloat32(n+t.offset+s,!0))}return r}case o.HALF_FLOAT:{if(t.count===1)return m(e.getUint16(n+t.offset,!0));const r=[];for(let i=0;i<t.count;i++){const s=i*Uint16Array.BYTES_PER_ELEMENT;r.push(m(e.getUint16(n+t.offset+s,!0)))}return r}}}class _{constructor(t,n,r,i,s,a,c,u,l=[]){this.entityTexel=t,this.anchorX=n,this.anchorY=r,this.directionX=i,this.directionY=s,this.maxScale=a,this.minScale=c,this.referenceBounds=u,this.bounds=l}serialize(t){t.push(this.entityTexel),t.writeF32(this.anchorX),t.writeF32(this.anchorY),t.writeF32(this.directionX),t.writeF32(this.directionY),t.writeF32(this.maxScale),t.writeF32(this.minScale),this.referenceBounds===null?(t.writeF32(0),t.writeF32(0),t.writeF32(0)):(t.writeF32(this.referenceBounds.size),t.writeF32(this.referenceBounds.offsetX),t.writeF32(this.referenceBounds.offsetY)),y(t,this.bounds)}static deserialize(t){const n=t.readInt32(),r=t.readF32(),i=t.readF32(),s=t.readF32(),a=t.readF32(),c=t.readF32(),u=t.readF32(),l=t.readF32(),g=t.readF32(),F=t.readF32(),w=I(t,R)??[];return new _(n,r,i,s,a,c,u,{size:l,offsetX:g,offsetY:F},w)}}export{V as $,W as a,tt as b,K as f,q as g,J as h,G as l,I as n,Z as o,X as p,_ as r,Y as s,p as t,j as w,Q as y};
