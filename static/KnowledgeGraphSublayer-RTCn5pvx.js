const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./lclayout-C72fYnMo.js","./_commonjsHelpers-DCkdB7M8.js"])))=>i.map(i=>d[i]);
import{e4 as et,fU as tt,dH as Le,_ as nt,gL as it,s as X,as as rt,fl as Z,ak as u,al as h,am as Ne,bq as at,aj as ye,av as re,es as we,dV as K,cL as ce,c3 as he,nl as _e,bF as Ye,h_ as ot,hL as st,hM as lt,de as pt,hK as dt,fn as yt,df as ut,eO as ct,eR as ht,hJ as mt,nm as ft,ce as ue,et as ie,hN as gt,cG as fe,d_ as ge,bC as Tt,hP as bt,at as wt,hO as Et,bE as It,ao as Nt,az as q,nn as Lt,no as _t,np as Dt,nq as Mt,hR as Rt,hS as vt,hT as St,eT as $t,ig as Ct,ih as kt,hU as At,nr as Ot,hV as xt,cF as jt,hW as Ft,kr as qt,fm as Pt,n1 as Gt,cC as Bt,di as Ut}from"./index-Dc2kMMi_.js";import"./GraphicsLayer-QmW4H4dl.js";import{W as Ht,M as ae,r as ze}from"./knowledgeGraphService-_tAFjVyW.js";import{s as te}from"./GraphQueryStreaming-D-7x3YUd.js";import{m as Qt}from"./FeatureStore-CMXj7f3E.js";import{V as Jt}from"./QueryEngine-lRc5zFwL.js";const V="ESRI__ID",Ee="ESRI__OriginID",Ie="ESRI__DestID",Ze="ESRI__LayoutGeometry",De="ESRI__AggregationCount",le="LC.ESRI__IsSpatial",Vt={initializeLayersFromClientData:async(e,t)=>{if(t||(t=[...e.layers,...e.tables].map(o=>o.graphTypeName)),(t==null?void 0:t.length)===0)return;const i=new Map;for(const o of t)i.set(o,Me(e,o));const n=await Ht(e.dataManager.knowledgeGraph,Array.from(i.values()));for(const o of[...e.layers,...e.tables]){const r=o.objectType.name;if(r===null)continue;const a=n.get(Me(e,r));if(a){const s=JSON.parse(a);s===null||typeof s!="object"||s.hasOwnProperty("showLabels")||(s.showLabels=!1),o.read(s,{origin:"service"})}}}},Me=(e,t)=>e.type==="knowledge-graph"?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function dn(e,t){return Vt.initializeLayersFromClientData(e,t)}let Te=class ne{constructor(){this._featureLookup=new Map}static getInstance(){return ne.instance||(ne.instance=new ne),ne.instance}static resetInstance(){ne.instance&&(ne.instance=null)}deleteFromStore(t){t.forEach(i=>{this._featureLookup.delete(i)})}readFromStoreByList(t){const i=[];return t.forEach(n=>{const o=this.readFromStoreById(n);o&&i.push(o)}),i}readFromStoreById(t){return this._featureLookup.get(t)??null}writeToStore(t,i,n){const o=[];return t.forEach(r=>{if(!(r!=null&&r.id))return;r.properties||(r.properties=[]);let a,s=null;if(n&&r.properties[n]&&(s=et(r.properties[n])),"originId"in r&&"destinationId"in r&&(r.properties[Ee]=r.originId,r.properties[Ie]=r.destinationId),r.properties[i]=r.id,r.id&&this._featureLookup.has(r.id)&&this._featureLookup.get(r.id).attributes){const l=this._featureLookup.get(r.id),c=JSON.parse(JSON.stringify(Object.assign(l.attributes,r.properties)));n&&r.properties[n]&&(c[n]=tt(r.properties[n])),a=new Le(s?JSON.parse(JSON.stringify(s)):l!=null&&l.geometry?JSON.parse(JSON.stringify(l.geometry)):null,c,null,r.properties[i])}else a=new Le(s?JSON.parse(JSON.stringify(s)):null,r.properties,null,r.properties[i]);this._featureLookup.set(`${r.typeName?`${r.typeName}__${r.id}`:r.id}`,a),o.push(a)}),o}},be,w=null;function yn(){return be||(be=nt(()=>import("./lclayout-C72fYnMo.js"),__vite__mapDeps([0,1]),import.meta.url).then(e=>e.l).then(({default:e})=>e({locateFile:t=>it(`esri/libs/linkchartlayout/${t}`)})).then(e=>{Wt(e)}),be)}function Wt(e){w=e}var Re,ve,pe,de;function Yt(e){const t=Object.keys(pe).filter(n=>isNaN(parseInt(n,10))).indexOf(e.timeDirection),i=Object.keys(de).filter(n=>isNaN(parseInt(n,10))).indexOf(e.eventsTicksVisualization);return{timeDirection:{value:t>-1?t:pe.right},timeBannerUTCOffsetInMinutes:e.timeBannerUTCOffsetInMinutes,eventsTicksVisualization:{value:i>-1?i:de.startAndEnd},showDurationLineForNonZeroDurationEntityEvents:e.showDurationLineForNonZeroDurationEntityEvents,durationLineWidth:e.durationLineWidth,entityPositionAtDurationRatio:e.entityPositionAtDurationRatio,showNonZeroDurationIntervalBounds:e.showNonZeroDurationIntervalBounds,separateTimeOverlaps:e.separateTimeOverlaps,separateTimelineOverlaps:e.separateTimelineOverlaps,moveFirstBends:e.moveFirstBends,secondBendRatio:e.secondBendRatio,lineSeparationMultiplier:e.lineSeparationMultiplier,spaceSeparatedLinesEvenly:e.spaceSeparatedLinesEvenly,useBezierCurves:e.useBezierCurves,separatedLineShapeRatio:e.separatedLineShapeRatio}}function ee(e,t,i,n,o,r){const a=i.length,s=o.length,l=Float64Array.BYTES_PER_ELEMENT,c=Uint32Array.BYTES_PER_ELEMENT,m=Uint8Array.BYTES_PER_ELEMENT,d=16,y=d+a*(m+2*l)+s*(2*c),b=w._malloc(y);try{const I=b+d-b%d,p=I+a*l,N=p+a*l,M=N+s*c,C=M+s*c,z=()=>[w.HEAPF64.subarray(I>>3,(I>>3)+a),w.HEAPF64.subarray(p>>3,(p>>3)+a),w.HEAPU32.subarray(N>>2,(N>>2)+s),w.HEAPU32.subarray(M>>2,(M>>2)+s),w.HEAPU8.subarray(C,C+a)],[G,O,v,A,B]=z();G.set(i),O.set(n),v.set(o),A.set(r),B.set(t);let x=e(a,C,I,p,s,N,M),j=null,F=null;if(x){const f=w.getLayoutLinksTypes(),k=w.getLayoutLinksVerticesEndIndices(),S=w.getLayoutLinksVertices(),$=w.countLayoutLinksVertices();!s||f&&k?$&&!S?x=!1:(j={types:new Uint8Array(w.HEAPU8.subarray(f,f+s)),vertexEndIndex:new Uint32Array(w.HEAPU32.subarray(k>>2,(k>>2)+s)),vertices:new Float64Array(w.HEAPF64.subarray(S>>3,(S>>3)+2*$))},F=w.getAuxiliaryGraphicElements()):x=!1}const[U,H,Q,Y,L]=z();return i.set(U),n.set(H),o.set(Q),r.set(Y),t.set(L),{success:x,links:j,graphics:F}}finally{w._free(b),w.cleanupLayout()}}(function(e){e[e.None=0]="None",e[e.IsMovable=1]="IsMovable",e[e.IsGeographic=2]="IsGeographic",e[e.IsRoot=4]="IsRoot",e[e.IsOld=8]="IsOld"})(Re||(Re={})),function(e){e[e.Regular=0]="Regular",e[e.Curved=1]="Curved",e[e.Recursive=2]="Recursive"}(ve||(ve={})),function(e){e[e.right=0]="right",e[e.left=1]="left",e[e.top=2]="top",e[e.bottom=3]="bottom"}(pe||(pe={})),function(e){e[e.none=0]="none",e[e.startOnly=1]="startOnly",e[e.startAndEnd=2]="startAndEnd"}(de||(de={}));const Se=2,$e=1,Ce=-1;var ke,Ae,Oe,xe,je,Fe,qe,Pe,Ge;(function(e){function t(){return w.getMinIdealEdgeLength()}function i(n,o,r,a,s,l=Se,c=$e,m=Ce){return ee((d,y,b,I,p,N,M)=>w.applyForceDirectedLayout(d,y,b,I,p,N,M,l,c,m),n,o,r,a,s)}e.getMinIdealEdgeLength=t,e.apply=i})(ke||(ke={})),function(e){function t(i,n,o,r,a,s=Se,l=$e,c=Ce){return ee((m,d,y,b,I,p,N)=>w.applyCommunityLayout(m,d,y,b,I,p,N,s,l,c),i,n,o,r,a)}e.apply=t}(Ae||(Ae={})),function(e){function t(i,n,o,r,a){return ee(w.applySimpleLayout,i,n,o,r,a)}e.apply=t}(Oe||(Oe={})),function(e){function t(i,n,o,r,a){return ee(w.applyHierarchicalLayout,i,n,o,r,a)}e.apply=t}(xe||(xe={})),function(e){function t(i,n,o,r,a){return ee(w.applyRadialTreeLayout,i,n,o,r,a)}e.apply=t}(je||(je={})),function(e){function t(i,n,o,r,a){return ee(w.applySmartTreeLayout,i,n,o,r,a)}e.apply=t}(Fe||(Fe={})),function(e){function t(i,n,o,r,a,s,l,c,m,d,y){const b={timeDirection:pe.right,timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:de.startAndEnd,showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0};return ee((I,p,N,M,C,z,G)=>{if(r.length!==I||a.length!==I||c.length!==C||m.length!==C)return!1;const O=Float64Array.BYTES_PER_ELEMENT,v=16,A=w._malloc(v+I*O),B=w._malloc(v+I*O),x=w._malloc(v+C*O),j=w._malloc(v+C*O),F=A+v-A%v,U=B+v-B%v,H=x+v-x%v,Q=j+v-j%v;try{w.HEAPF64.subarray(F>>3,(F>>3)+I).set(r),w.HEAPF64.subarray(U>>3,(U>>3)+I).set(a),w.HEAPF64.subarray(H>>3,(H>>3)+C).set(c),w.HEAPF64.subarray(Q>>3,(Q>>3)+C).set(m);const Y=Yt(Object.assign(b,y));return w.applyChronologicalLayout(I,p,N,M,F,U,C,z,G,H,Q,d,Y)}finally{w._free(A),w._free(B),w._free(x),w._free(j)}},i,n,o,s,l)}e.apply=t}(qe||(qe={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(Pe||(Pe={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(Ge||(Ge={}));var me;(function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"})(me||(me={}));me.ELEMENTUID,me.TYPENAME;var Be,Ue;(function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"})(Be||(Be={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(Ue||(Ue={}));var He,Qe,Je,oe;(function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"})(He||(He={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(Qe||(Qe={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(Je||(Je={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(oe||(oe={}));function zt(e){if(!e.spatialReference.isWGS84)throw new X("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map(t=>[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]])}async function un(e,t){var r,a;const i=[],n=new Map,o=[];if((r=t.dataModel)!=null&&r.relationshipTypes)for(const s of t.dataModel.relationshipTypes)s.name&&n.set(s.name,[]);for(const s of e)n.has(s.typeName)&&((a=n.get(s.typeName))==null||a.push(s.id));for(const[s,l]of n){if(l.length<1)continue;const c=new te({openCypherQuery:`MATCH (n)-[r:${s}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:l}});o.push(ae(t,c).then(async m=>{const d=m.resultRowsStream.getReader();for(;;){const{done:y,value:b}=await d.read();if(y)break;for(const I of b)i.push({id:I[0],typeName:I[1]}),i.push({id:I[2],typeName:I[3]})}}))}return await Promise.all(o),i}async function cn(e,t){t??(t=!1);const i={generateAllSublayers:t,namedTypeDefinitions:new Map};return await Kt(e).then(n=>{en(n,i)}),i}async function hn(e){const t=await ze(),i=new t.MapOfObjectIdentifierSets;Zt(i,t,e);const n=new t.MapOfObjectIdentifierSetsEncoder;try{n.set_map_of_identifier_sets(i),n.encode();const o=n.get_encoding_result();if(o.error.error_code!==0)throw new X("knowledge-graph:layer-support-utils",o.error.error_message);const r=structuredClone(o.get_byte_buffer());return n.delete(),r}finally{i.delete()}}function Zt(e,t,i){for(const[n,o]of i.namedTypeDefinitions){if(!o.members||o.useAllData)continue;const r=o.members.keys();let a=!1,s=!0;const l=new t.ObjectIdArray,c=new t.StringArray,m=new t.GlobalIdArray,d=new t.IdentifierArray,y=new t.ObjectIdentifierSet;for(const b of r)s&&(a=!isNaN(Number(b)),s=!1),a?l.add_objectid(Number(b)):(c.add_string(b),m.add_globalid(b)),d.add_identifier(b);y.set_oid_array(l),y.set_string_array(c),y.set_globalid_array(m),y.set_identifier_array(d),l.delete(),c.delete(),m.delete(),d.delete(),e.put_identifier_set(n,y),y.delete()}return e}async function Kt(e){const t=await rt(e,{responseType:"array-buffer"}),i=await t.data;return Xt(new Uint8Array(i))}async function Xt(e){const t=new(await ze()).MapOfObjectIdentifierSetsDecoder,i=t.decode(new Uint8Array(e)),n=new Map;if(i.error_code!==0)throw new X("knowledge-graph:layer-support-utils",i.error_message);const o=t.get_map_of_identifier_sets(),r=o.keys,a=r.size();for(let s=0;s<a;s++){const l=r.get(s),c=o.query_identifier_set(l),m=[];if(c.id_array_type.value===oe.GLOBALID_ARRAY){const d=c.get_globalid_array(),y=d.count();for(let b=0;b<y;b++)m.push(d.get_globalid_at(b))}else if(c.id_array_type.value===oe.IDENTIFIER_ARRAY){const d=c.get_identifier_array(),y=d.count();for(let b=0;b<y;b++)m.push(d.get_identifier_at(b).toString())}else if(c.id_array_type.value===oe.STRING_ARRAY){const d=c.get_string_array(),y=d.count();for(let b=0;b<y;b++)m.push(d.get_string_at(b))}else{if(c.id_array_type.value!==oe.OID_ARRAY)throw new X("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const d=c.get_oid_array(),y=d.count();for(let b=0;b<y;b++)m.push(d.get_objectid_at(b).toString())}}n.set(l,m)}return t.delete(),n}function en(e,t){for(const[i,n]of e){const o=Z(t.namedTypeDefinitions,i,()=>({useAllData:!1,members:new Map}));for(const r of n)o.members.has(r)||o.members.set(r,{id:r})}return t}let J=class extends at{constructor(e){var i,n,o;super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;(i=e.knowledgeGraph.dataModel.entityTypes)==null||i.forEach(r=>{var a,s;r.name&&(t.set(r.name,"entity"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!((a=e.inclusionModeDefinition)!=null&&a.generateAllSublayers)||this.entityTypeNames.add(r.name),(s=r.properties)==null||s.forEach(l=>{l.geometryType&&l.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(r.name,{name:l.name??"",geometryType:l.geometryType})}))}),(n=e.knowledgeGraph.dataModel.relationshipTypes)==null||n.forEach(r=>{var a,s;r.name&&(t.set(r.name,"relationship"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!((a=e.inclusionModeDefinition)!=null&&a.generateAllSublayers)||this.relationshipTypeNames.add(r.name),(s=r.properties)==null||s.forEach(l=>{l.geometryType&&l.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(r.name,{name:l.name??"",geometryType:l.geometryType})}))}),(o=e.inclusionModeDefinition)==null||o.namedTypeDefinitions.forEach((r,a)=>{var l,c;if(t.get(a)==="entity")this.entityTypeNames.add(a);else{if(t.get(a)!=="relationship")return ye.getLogger(this).warn(`A named type, ${a}, was in the inclusion list that wasn't in the data model and will be removed`),void((l=e.inclusionModeDefinition)==null?void 0:l.namedTypeDefinitions.delete(a));this.relationshipTypeNames.add(a)}const s=new Map;(c=r.members)==null||c.forEach(m=>{Z(this.memberIdTypeLookup,m.id,()=>new Set).add(a);const d=this.getById(m.id);d&&s.set(m.id,d)}),this.sublayerCaches.set(a,s)})}addToLayer(e){e.forEach(({typeName:t,id:i})=>{if(!this.inclusionModeDefinition)throw new X("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){const n=this.inclusionModeDefinition.namedTypeDefinitions.get(t);n.members||(n.members=new Map),n.members.set(i,{id:i}),Z(this.memberIdTypeLookup,i,()=>new Set).add(t)}}else{const n=new Map;n.set(i,{id:i}),this.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:n}),Z(this.memberIdTypeLookup,i,()=>new Set).add(t)}})}getById(e){return Te.getInstance().readFromStoreById(e)}async getData(e,t,i){var o,r;if(t.objectType.name&&((o=this.inclusionModeDefinition)!=null&&o.namedTypeDefinitions)&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let n;if(n=e||new re({where:"1=1",outFields:["*"]}),t.parentCompositeLayer.type==="link-chart"){const a=t.parentCompositeLayer,s=this._processingCacheUpdatesLookup.get(t.objectType.name??""),l=n.outFields;l&&l.length===1&&l[0]===V&&n.where==="1=1"||await Promise.all(s??[]);const c=this.sublayerCaches.has(t.objectType.name??"")?Array.from((r=this.sublayerCaches.get(t.objectType.name))==null?void 0:r.values()):[],m=[];return c.forEach(d=>{if(this.relationshipTypeNames.has(t.objectType.name)){d.geometry=a.relationshipLinkChartDiagramLookup.get(d.attributes[t.objectIdField]);const y=this.memberIdTypeLookup.get(d.attributes[Ee]),b=this.memberIdTypeLookup.get(d.attributes[Ie]),I=this._isEndEntitySpatial(y,d,Ee),p=this._isEndEntitySpatial(b,d,Ie);d.attributes[le]=Number(I&&p)}else{d.geometry=a.entityLinkChartDiagramLookup.get(d.attributes[t.objectIdField]);const y=this.geographicLookup.get(t.objectType.name);y&&d.attributes[y.name]?d.attributes[le]=1:d.attributes[le]=0}d.attributes[Ze]=d.geometry,m.push(d)}),m}return this.retrieveDataFromService(n,t,i)}async getConnectedRecordIds(e,t){const i=[];let n="";const o=[],r=new Map;if(e.forEach(m=>{var d;if(this.memberIdTypeLookup.has(m))for(const y of this.memberIdTypeLookup.get(m)){if(!this.entityTypeNames.has(y))return;r.has(y)?(d=r.get(y))==null||d.push(m):r.set(y,[m])}}),t&&(t==null?void 0:t.length)!==0){for(const m of t)n=n+m+"|";n=n.slice(0,-1)}const a={};let s="",l=-1;for(const[m,d]of r){l++,l!==0&&(s+=" UNION ");const y=`${m}_ids`;a[y]=d,s+=t&&(t==null?void 0:t.length)!==0?`MATCH (n:${m}) WHERE id(n) IN $${y} WITH n MATCH (n)-[r:${n}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${m}) WHERE id(n) IN $${y} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`}if(!s)return i;const c=new Promise(m=>{(async()=>{const d=(await ae(this.knowledgeGraph,new te({openCypherQuery:s,bindParameters:a}))).resultRowsStream.getReader();try{for(;;){const{done:y,value:b}=await d.read();if(y)break;for(let I=0;I<b.length;I++){const p=b[I];i.push({id:p[0],typeName:p[1]}),i.push({id:p[2],typeName:p[3]})}}}catch(y){if(y.name!=="AbortError")throw y;ye.getLogger(this).info("Request aborted as expected")}})().then(()=>{m()})});return o.push(c),this.refreshCacheContent(),await Promise.all(o),i}async getRelationshipsBetweenNodes(e,t){const i=[],n="MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",o=(await ae(this.knowledgeGraph,new te({openCypherQuery:n,bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){const{done:r,value:a}=await o.read();if(r)break;for(let s=0;s<a.length;s++){const l=a[s];i.push({id:l[0],typeName:l[1]})}}}catch(r){if(r.name!=="AbortError")throw r;ye.getLogger(this).info("Request aborted as expected")}return i}async getRelationshipsFromNodes(e,t,i){const n=[],o="MATCH (n)-[r]-(m) WHERE id(n) IN $targetEntityIds AND id(m) in $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",r=(await ae(this.knowledgeGraph,new te({openCypherQuery:o,bindParameters:{targetEntityIds:e,possibleConnectionEntityIds:t,relationshipExclusionIds:i}}))).resultRowsStream.getReader();try{for(;;){const{done:a,value:s}=await r.read();if(a)break;for(let l=0;l<s.length;l++){const c=s[l];n.push({id:c[0],typeName:c[1]})}}}catch(a){if(a.name!=="AbortError")throw a;ye.getLogger(this).info("Request aborted as expected")}return n}async refreshCacheContent(e,t,i,n=!0){var l,c,m,d,y,b,I;const o=Te.getInstance(),r=[],a=new Map,s=new Map;(l=this.knowledgeGraph.dataModel.entityTypes)==null||l.forEach(p=>{p.name&&s.set(p.name,p)}),(c=this.knowledgeGraph.dataModel.relationshipTypes)==null||c.forEach(p=>{p.name&&s.set(p.name,p)}),e||this.inclusionModeDefinition?e?e.forEach(p=>{var N;if(this.memberIdTypeLookup.has(p))for(const M of this.memberIdTypeLookup.get(p))a.has(M)?(N=a.get(M))==null||N.push(p):a.set(M,[p])}):(d=(m=this.inclusionModeDefinition)==null?void 0:m.namedTypeDefinitions)==null||d.forEach((p,N)=>{p.useAllData?a.set(N,null):p.members&&p.members.forEach(M=>{var C;a.has(N)&&a.get(N)!==null?(C=a.get(N))==null||C.push(M.id):a.set(N,[M.id])})}):((y=this.knowledgeGraph.dataModel.entityTypes)==null||y.forEach(p=>{p.name&&a.set(p.name,null)}),(b=this.knowledgeGraph.dataModel.entityTypes)==null||b.forEach(p=>{p.name&&a.set(p.name,null)}));for(const[p,N]of a){const M=new Promise(C=>{(async()=>{var j,F,U,H,Q,Y,L;const G=new Set,O=[];let v,A="",B=!1;if(t||((F=(j=s.get(p))==null?void 0:j.properties)==null||F.forEach(f=>{f.name&&G.add(f.name)})),i&&this.geographicLookup.has(p)){const f=(U=this.geographicLookup.get(p))==null?void 0:U.name;f&&G.add(f)}if(this.entityTypeNames.has(p))A=`MATCH (n:${p}) ${N?"WHERE id(n) IN $ids ":""}return ID(n)`,G.forEach(f=>{A+=`, n.${f}`,O.push(f)});else{if(!this.relationshipTypeNames.has(p))throw new X("knowledge-graph:layer-data-manager",`The graph type of ${p} could not be determined. Was this type set in the KG data model and inclusion definition?`);B=!0,A=`MATCH ()-[n:${p}]->() ${N?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,G.forEach(f=>{A+=`, n.${f}`,O.push(f)})}v=new te(N?{openCypherQuery:A,bindParameters:{ids:N}}:{openCypherQuery:A});const x=(await ae(this.knowledgeGraph,v)).resultRowsStream.getReader();for(;;){const{done:f,value:k}=await x.read();if(f)break;const S=[];for(let _=0;_<k.length;_++){const E=k[_];let g=0,W=0;const R={properties:{}};for(R.id=E[g],g++,W++,B&&(R.originId=E[g],g++,W++,R.destinationId=E[g],g++,W++,Z(this.nodeConnectionsLookup,R.originId,()=>new Set).add(R.id),Z(this.nodeConnectionsLookup,R.destinationId,()=>new Set).add(R.id),Z(this.relationshipConnectionsLookup,R.id,()=>[R.originId,R.destinationId]));g<E.length;g++)R.properties[O[g-W]]=E[g];S.push(R)}const $=o.writeToStore(S,V,(H=this.geographicLookup.get(p))==null?void 0:H.name);this.sublayerCaches.has(p)||this.sublayerCaches.set(p,new Map),n&&!((Q=this.inclusionModeDefinition)!=null&&Q.namedTypeDefinitions.has(p))&&((Y=this.inclusionModeDefinition)==null||Y.namedTypeDefinitions.set(p,{useAllData:!1,members:new Map})),n&&!((L=this.inclusionModeDefinition)!=null&&L.namedTypeDefinitions.get(p).members)&&(this.inclusionModeDefinition.namedTypeDefinitions.get(p).members=new Map);const D=this.sublayerCaches.get(p);$.forEach(_=>{var E,g;D==null||D.set(_.attributes[V],_),n&&!((E=this.inclusionModeDefinition)!=null&&E.namedTypeDefinitions.get(p).members.has(_.attributes[V]))&&((g=this.inclusionModeDefinition)==null||g.namedTypeDefinitions.get(p).members.set(_.attributes[V],{id:_.attributes[V]}),Z(this.memberIdTypeLookup,_.attributes[V],()=>new Set).add(p))})}})().then(()=>{C(null)})});r.push(M),(I=this._processingCacheUpdatesLookup.get(p))==null||I.push(M)}await Promise.all(r)}removeFromLayer(e){var n,o,r;const t=new Set,i=new Set(e.map(a=>a.id));for(const a of e)t.add(a.typeName),((n=this.memberIdTypeLookup.get(a.id))==null?void 0:n.size)===1?this.memberIdTypeLookup.delete(a.id):(o=this.memberIdTypeLookup.get(a.id))==null||o.delete(a.typeName),(r=this.inclusionModeDefinition)==null||r.namedTypeDefinitions.forEach((s,l)=>{var c;l===a.typeName&&((c=s.members)!=null&&c.has(a.id))&&s.members.delete(a.id)});t.forEach(a=>{var s;(s=this.sublayerCaches.get(a))==null||s.forEach((l,c)=>{var m;i.has(c)&&((m=this.sublayerCaches.get(a))==null||m.delete(c))})})}async retrieveDataFromService(e,t,i){var I,p,N,M,C,z,G,O,v,A,B,x,j,F,U,H,Q,Y;const n=Te.getInstance(),o=new Set,r=[];let a,s="",l=[];const c=t.graphType==="relationship",m=(N=(p=(I=this.inclusionModeDefinition)==null?void 0:I.namedTypeDefinitions)==null?void 0:p.get(t.objectType.name))==null?void 0:N.useAllData,d=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let y=!m&&d?Array.from(d).sort():null;if((z=(C=(M=this.inclusionModeDefinition)==null?void 0:M.namedTypeDefinitions)==null?void 0:C.get(t.objectType.name))!=null&&z.useAllData)(v=(O=(G=this.inclusionModeDefinition)==null?void 0:G.namedTypeDefinitions)==null?void 0:O.get(t.objectType.name))!=null&&v.useAllData&&e.objectIds!=null&&(y=e.objectIds);else if(e.objectIds!=null&&y&&y.length>0){const L=e.objectIds;e.objectIds=y.filter(f=>L.includes(f))}else if(e.objectIds!=null)y=e.objectIds;else{if((A=this.inclusionModeDefinition)!=null&&A.namedTypeDefinitions.has(t.objectType.name)&&(!((B=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))!=null&&B.members)||((j=(x=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))==null?void 0:x.members)==null?void 0:j.size)<1))return e.objectIds=[],[];e.objectIds=y}if(e.outFields!=null){const L=e.outFields;L.includes("*")?t.fields.forEach(f=>{o.add(f.name)}):L.forEach(f=>{f!==V&&f!==t.geometryFieldName&&o.add(f)})}if(e.geometry!=null){const L=e.geometry;let f;const k=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,S=k==null?void 0:k.spatialReference,$=(F=k==null?void 0:k.serviceCapabilities)==null?void 0:F.geometryCapabilities;let D=$==null?void 0:$.geometryMaxBoundingRectangleSizeX,_=$==null?void 0:$.geometryMaxBoundingRectangleSizeY;if(L.type==="point"){let E=L;(U=E.spatialReference)!=null&&U.isWGS84||(await we(E.spatialReference,K),E=ce(E,K)),f=new he({spatialReference:K,xmin:E.x-1e-4,ymin:E.y-1e-4,xmax:E.x+1e-4,ymax:E.y+1e-4})}else(H=L==null?void 0:L.extent)!=null&&H.spatialReference&&!((Q=L.spatialReference)!=null&&Q.isWGS84)?(await we(L.extent.spatialReference,K),f=ce(L.extent,K)):f=L.extent;if(D&&_&&S){if(S.wkid!==4326){const E=new he({spatialReference:S,xmax:D,ymax:_}),g=ce(E,K);D=g.xmax,_=g.ymax}if(f.xmax-f.xmin>D)throw new X("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${D}° latitude, limit exceeded`);if(f.ymax-f.ymin>_)throw new X("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${_}° longitude, limit exceeded`)}if(e.where!=null&&e.where!=="1=1"){const E=await _e(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach(g=>{E.fieldNames.includes(g.name)&&o.add(g.name)})}s=c?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&o.add(t.geometryFieldName),o.forEach(E=>{s+=`, n.${E}`,r.push(E)}),a=new te({openCypherQuery:s,bindParameters:{param_filter_geom:new Ye({rings:zt(f)})}})}else{let L="";if(e.where!=null&&e.where!=="1=1"){const S=await _e(e.where,t.fieldsIndex);t.fields.forEach(g=>{S.fieldNames.includes(g.name)&&o.add(g.name)});const $=new Set(["column-reference","string","number","binary-expression"]),D=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let _=!1;const E=g=>{if(g.type==="column-reference")return`n.${g.column}`;if(g.type==="string")return`'${g.value}'`;if(g.type==="number")return`${g.value}`;if(g.type==="binary-expression"&&$.has(g.left.type)&&$.has(g.right.type)&&D.has(g.operator))return`${E(g.left)} ${g.operator} ${E(g.right)}`;if(g.type==="binary-expression"&&g.operator==="LIKE"){let W="";if(g.left.type==="function"&&g.left.args.value[0].type==="column-reference")W+=`lower(n.${g.left.args.value[0].column})`;else{if(g.left.type!=="column-reference")return _=!0,"";W+=`lower(n.${g.left.column})`}if(W+=" CONTAINS (",g.right.type!=="string")return _=!0,"";{let R=g.right.value;R.charAt(0)==="%"&&(R=R.slice(1)),R.charAt(R.length-1)==="%"&&(R=R.slice(0,-1)),W+=`'${R.toLowerCase()}')`}return W}return _=!0,""};L=E(S.parseTree),_&&(L="")}let f="";f=c?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let k=!1;y&&(k=!0,f+=" WHERE ID(n) IN $ids"),L&&(f+=k?" AND":" WHERE",f+=` ${L}`),f+=" return ID(n)",c&&(f+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&o.add(t.geometryFieldName),o.forEach(S=>{f+=`, n.${S}`,r.push(S)}),a=new te(y?{openCypherQuery:f,bindParameters:{ids:y}}:{openCypherQuery:f})}const b=(await ae(t.parentCompositeLayer.dataManager.knowledgeGraph,a,i)).resultRowsStream.getReader();for(;;){const{done:L,value:f}=await b.read();if(L)break;const k=[];for(let S=0;S<f.length;S++){const $=f[S];let D=0,_=0;const E={properties:{}};for(E.id=$[D],D++,_++,c&&(E.originId=$[D],D++,_++,E.destinationId=$[D],D++,_++);D<$.length;D++)E.properties[r[D-_]]=$[D];k.push(E)}l=l.concat(n.writeToStore(k,V,(Y=t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name))==null?void 0:Y.name))}return l}_isEndEntitySpatial(e,t,i){var n;for(const o of e??[])if(this.entityTypeNames.has(o)){const r=this.geographicLookup.get(o),a=r&&((n=this.sublayerCaches.get(o))==null?void 0:n.get(t.attributes[i]));if(r&&(a!=null&&a.attributes[r.name]))return!0}return!1}};u([h()],J.prototype,"knowledgeGraph",void 0),u([h()],J.prototype,"inclusionModeDefinition",void 0),u([h()],J.prototype,"entityTypeNames",void 0),u([h()],J.prototype,"relationshipTypeNames",void 0),u([h()],J.prototype,"geographicLookup",void 0),u([h()],J.prototype,"sublayerCaches",void 0),u([h()],J.prototype,"nodeConnectionsLookup",void 0),u([h()],J.prototype,"relationshipConnectionsLookup",void 0),u([h()],J.prototype,"memberIdTypeLookup",void 0),J=u([Ne("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],J);const Ve=ot(),tn=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return u([h(Ve.fields)],t.prototype,"fields",void 0),u([h(Ve.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=u([Ne("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};function P(e){if(!e.json)return e;e.json.write=We(e.json.write);const t=e.json.origins;if(!t)return e;let i;for(i in t){const n=t[i];n&&(n.write=We(n.write))}return e}function We(e){return typeof e=="object"&&e?(e.enabled!==!1&&(e.overridePolicy=nn(e)),e):e===!0?se():e}function nn(e){const{target:t,writer:i,overridePolicy:n,...o}=e;return function(r,a){const s=Ke.call(this,r,a);return s.enabled?{...o,...s}:s}}function se(){return{overridePolicy:Ke}}function Ke(e,t){const i=!!this.geometryType;let n={enabled:i};return i&&(n={...n,...Xe.call(this,e,t)}),n}function Xe(e,t){return{ignoreOrigin:this.originIdOf(t)>Bt.DEFAULTS}}let T=class extends tn(st(lt(pt(dt(yt(ut(ct(ht(Ut))))))))){constructor(e){super(e),this.blendMode="normal",this.capabilities=mt(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=V,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then(()=>{const t=new MessageChannel;return new ft(t.port1,{channel:t,client:{queryFeatures:(i,n={})=>{const o=re.fromJSON(i);return this.queryFeaturesJSON(o,n)}}}),[t.port2]})},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){var t,i;const e=[];return(i=(t=this.objectType)==null?void 0:t.properties)==null||i.forEach(n=>{const o=n.fieldType==="esriFieldTypeOID"?"esriFieldTypeInteger":n.fieldType;e.push(ue.fromJSON({name:n.name,type:o,alias:n.alias,defaultValue:n.defaultValue,editable:n.editable,nullable:n.nullable}))}),e.push(ue.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),ue.fromJSON({name:De,type:"esriFieldTypeInteger",alias:De,editable:!1}),ue.fromJSON({name:le,type:"esriFieldTypeInteger",alias:le,editable:!1})),e}get geometryType(){var i,n,o;if(((i=this.parentCompositeLayer)==null?void 0:i.type)==="link-chart")return this.graphType==="relationship"?"polyline":"point";const e=(o=this.parentCompositeLayer)==null?void 0:o.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name),t=e==null?void 0:e.geometryType;return t&&t!=="esriGeometryNull"?ie.fromJSON(t):null}get geometryFieldName(){var t,i,n;if(((t=this.parentCompositeLayer)==null?void 0:t.type)==="link-chart")return Ze;const e=(n=this.parentCompositeLayer)==null?void 0:n.dataManager.geographicLookup.get((i=this.objectType)==null?void 0:i.name);return(e==null?void 0:e.name)??null}get graphTypeName(){var e;return(e=this.objectType)==null?void 0:e.name}get hasM(){var n,o,r,a;const e=(o=this.parentCompositeLayer)==null?void 0:o.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name),t=e==null?void 0:e.name,i=t?(a=(r=this.objectType)==null?void 0:r.properties)==null?void 0:a[t]:null;return(i==null?void 0:i.hasM)??!1}get hasZ(){var n,o,r,a;const e=(o=this.parentCompositeLayer)==null?void 0:o.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name),t=e==null?void 0:e.name,i=t?(a=(r=this.objectType)==null?void 0:r.properties)==null?void 0:a[t]:null;return(i==null?void 0:i.hasZ)??!1}set renderer(e){gt(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){var e;return this._isOverridden("renderer")?this._get("renderer"):((e=this.parentCompositeLayer)==null?void 0:e.type)==="link-chart"?this.graphType==="relationship"?fe(ge(ie.toJSON("polyline")).renderer):fe(ge(ie.toJSON("point")).renderer):fe(ge(ie.toJSON(this.geometryType)).renderer)}get spatialReference(){var e,t,i,n;return((n=(i=(t=(e=this.parentCompositeLayer)==null?void 0:e.dataManager)==null?void 0:t.knowledgeGraph)==null?void 0:i.dataModel)==null?void 0:n.spatialReference)??Tt.WGS84}set timeInfo(e){this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return bt(this,e)}createQuery(){return new re({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e),o=wt.fromJSON(await n.executeQuery(i.toJSON(),t==null?void 0:t.signal));return o.features.forEach(r=>{r.sourceLayer=this}),o}async queryFeaturesJSON(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return await n.executeQuery(i.toJSON(),t==null?void 0:t.signal)}async queryFeatureCount(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return n.executeQueryForCount(i.toJSON(),t==null?void 0:t.signal)}async queryExtent(e={},t){var s,l,c,m;const i={...e,returnGeometry:!0},{resolvedQuery:n,queryEngine:o}=await this._setupQueryObjects(i),r=await o.executeQueryForExtent(n.toJSON(),t==null?void 0:t.signal);let a;return a=((s=r.extent)==null?void 0:s.xmin)!=null&&((l=r.extent)==null?void 0:l.xmax)!=null&&((c=r.extent)==null?void 0:c.ymin)!=null&&((m=r.extent)==null?void 0:m.ymax)!=null?new he(r.extent):new he,{count:r.count,extent:a}}async queryObjectIds(e,t){const i=re.from(e);let n;if(this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)n=this._cachedQueryEngine;else{const o=await this.parentCompositeLayer.dataManager.getData(i,this,t);n=this.loadQueryEngine(o)}return n.executeQueryForIds(i.toJSON(),t==null?void 0:t.signal)}loadQueryEngine(e){var n;const t=new Qt({geometryType:ie.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),i=new Jt({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:ie.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:(n=this.timeInfo)==null?void 0:n.toJSON(),featureStore:t});return i.featureStore.addMany(e),i}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new re({where:"1=1",outFields:[V]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}load(e){return this.addResolvingPromise(this.parent.load(e).then(()=>{Et(this.timeInfo,this.fieldsIndex)})),Promise.resolve(this)}async _setupQueryObjects(e,t){var r;const i=re.from(e),n=i.geometry;let o;if(n&&!((r=n.spatialReference)!=null&&r.isWGS84)&&(await we(n.spatialReference,K),i.geometry=ce(n instanceof Ye||n instanceof It||n instanceof Nt?n:n.extent,K)),this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)o=this._cachedQueryEngine;else{const a=await this.parentCompositeLayer.dataManager.getData(i,this,t);o=this.loadQueryEngine(a)}return{resolvedQuery:i,queryEngine:o}}};u([h(P(q(Lt)))],T.prototype,"blendMode",void 0),u([h()],T.prototype,"capabilities",void 0),u([h({json:{origins:{"web-scene":{write:!1}},write:se()}})],T.prototype,"charts",void 0),u([h({readOnly:!0})],T.prototype,"defaultPopupTemplate",null),u([h({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],T.prototype,"definitionExpression",void 0),u([h()],T.prototype,"displayField",void 0),u([h(P(q(_t)))],T.prototype,"effect",void 0),u([h()],T.prototype,"elevationInfo",void 0),u([h(P(q(Dt)))],T.prototype,"featureEffect",void 0),u([h(P(q(Mt)))],T.prototype,"featureReduction",null),u([h()],T.prototype,"fields",null),u([h()],T.prototype,"geometryType",null),u([h()],T.prototype,"geometryFieldName",null),u([h({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],T.prototype,"graphType",void 0),u([h({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],T.prototype,"graphTypeName",null),u([h()],T.prototype,"hasM",null),u([h()],T.prototype,"hasZ",null),u([h({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],T.prototype,"id",void 0),u([h(P(q(Rt)))],T.prototype,"labelsVisible",void 0),u([h({type:[vt],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:St,write:se()}})],T.prototype,"labelingInfo",void 0),u([h({readOnly:!0,json:{read:!1,write:{writer(e,t){switch(this.parentCompositeLayer.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],T.prototype,"layerType",void 0),u([h(P(q($t)))],T.prototype,"legendEnabled",void 0),u([h(P(q(Ct)))],T.prototype,"maxScale",void 0),u([h(P(q(kt)))],T.prototype,"minScale",void 0),u([h()],T.prototype,"objectIdField",void 0),u([h()],T.prototype,"objectType",void 0),u([h(P(q(At)))],T.prototype,"opacity",void 0),u([h(P(q(Ot)))],T.prototype,"orderBy",void 0),u([h({clonable:!1})],T.prototype,"parent",void 0),u([h()],T.prototype,"parentCompositeLayer",void 0),u([h(P(q(xt)))],T.prototype,"popupEnabled",void 0),u([h({type:jt,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],T.prototype,"popupTemplate",void 0),u([h({type:Number,json:{write:{overridePolicy:Xe}}})],T.prototype,"refreshInterval",void 0),u([h({types:Ft,json:{name:"layerDefinition.drawingInfo.renderer",write:se()}})],T.prototype,"renderer",null),u([h()],T.prototype,"source",void 0),u([h()],T.prototype,"spatialReference",null),u([h({type:qt,json:{name:"layerDefinition.timeInfo",write:!0,origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:!0},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:!0}}}})],T.prototype,"timeInfo",null),u([h({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],T.prototype,"title",null),u([Pt("title")],T.prototype,"writeTitle",null),u([h({json:{read:!1}})],T.prototype,"type",void 0),u([h(P(q(Gt)))],T.prototype,"useViewTime",void 0),u([h({type:Boolean,json:{name:"visibility",write:se()}})],T.prototype,"visible",void 0),T=u([Ne("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],T);const mn=T;export{un as A,J as E,cn as F,Fe as L,hn as R,Ae as a,qe as b,dn as c,V as d,yn as e,ke as f,De as g,xe as h,Te as i,je as m,Ze as n,ve as o,Ie as r,Re as s,Ee as t,mn as u,Oe as v};
